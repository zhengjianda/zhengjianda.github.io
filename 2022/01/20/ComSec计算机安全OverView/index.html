<!DOCTYPE html><html lang="zh-Hans"><head><meta charset="UTF-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1"><meta name="description" content="ComSec概念概述"><meta name="keywords" content="计算机安全"><meta name="author" content="luo,1127959736@qq.com"><meta name="copyright" content="luo"><title>ComSec概念概述 | luo's Blog</title><link rel="shortcut icon" href="/melody-favicon.ico"><link rel="stylesheet" href="/css/index.css?version=1.9.0"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/font-awesome@latest/css/font-awesome.min.css?version=1.9.0"><meta name="format-detection" content="telephone=no"><meta http-equiv="x-dns-prefetch-control" content="on"><link rel="dns-prefetch" href="https://cdn.jsdelivr.net"><link rel="stylesheet" type="text/css" href="https://cdn.jsdelivr.net/npm/gitalk/dist/gitalk.min.css"><script src="https://cdn.jsdelivr.net/npm/gitalk@latest/dist/gitalk.min.js"></script><script src="https://cdn.jsdelivr.net/npm/blueimp-md5@2.10.0/js/md5.min.js"></script><meta http-equiv="Cache-Control" content="no-transform"><meta http-equiv="Cache-Control" content="no-siteapp"><script src="https://v1.hitokoto.cn/?encode=js&amp;charset=utf-8&amp;select=.footer_custom_text" defer></script><script>var GLOBAL_CONFIG = { 
  root: '/',
  algolia: undefined,
  localSearch: {"path":"search.xml","languages":{"hits_empty":"找不到您查询的内容:${query}"}},
  copy: {
    success: '复制成功',
    error: '复制错误',
    noSupport: '浏览器不支持'
  },
  hexoVersion: '5.4.0'
} </script><meta name="generator" content="Hexo 5.4.0"><link rel="alternate" href="/atom.xml" title="luo's Blog" type="application/atom+xml">
</head><body><canvas class="fireworks"></canvas><i class="fa fa-arrow-right" id="toggle-sidebar" aria-hidden="true"></i><div id="sidebar" data-display="true"><div class="toggle-sidebar-info text-center"><span data-toggle="切换文章详情">切换站点概览</span><hr></div><div class="sidebar-toc"><div class="sidebar-toc__title">目录</div><div class="sidebar-toc__progress"><span class="progress-notice">你已经读了</span><span class="progress-num">0</span><span class="progress-percentage">%</span><div class="sidebar-toc__progress-bar"></div></div><div class="sidebar-toc__content"><ol class="toc"><li class="toc-item toc-level-1"><a class="toc-link" href="#comsec%E6%80%BB%E7%BB%93"><span class="toc-number">1.</span> <span class="toc-text"> ComSec总结</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#%E5%85%AC%E9%92%A5%E5%AF%86%E7%A0%81%E5%AD%A6%E6%A6%82%E8%BF%B0"><span class="toc-number">1.1.</span> <span class="toc-text"> 公钥密码学概述</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#%E5%8A%A0%E5%AF%86%E6%A8%A1%E5%BC%8F"><span class="toc-number">1.1.1.</span> <span class="toc-text"> 加密模式</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E8%AE%A4%E8%AF%81%E6%A8%A1%E5%BC%8F"><span class="toc-number">1.1.2.</span> <span class="toc-text"> 认证模式</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E5%90%8C%E6%97%B6%E5%85%B7%E6%9C%89%E4%BF%9D%E5%AF%86%E4%B8%8E%E8%AE%A4%E8%AF%81%E7%9A%84%E5%85%AC%E9%92%A5%E4%BD%93%E8%B4%A8"><span class="toc-number">1.1.3.</span> <span class="toc-text"> 同时具有保密与认证的公钥体质</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E5%85%AC%E9%92%A5%E5%AF%86%E7%A0%81%E4%BD%93%E5%88%B6%E5%BA%94%E6%BB%A1%E8%B6%B3%E7%9A%84%E8%A6%81%E6%B1%82"><span class="toc-number">1.1.4.</span> <span class="toc-text"> 公钥密码体制应满足的要求</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E5%85%B3%E4%BA%8E%E5%85%AC%E9%92%A5%E5%AF%86%E7%A0%81%E7%9A%84%E5%87%A0%E7%A7%8D%E8%AF%AF%E8%A7%A3"><span class="toc-number">1.1.5.</span> <span class="toc-text"> 关于公钥密码的几种误解</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#rsa"><span class="toc-number">1.2.</span> <span class="toc-text"> RSA</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#rsa%E7%AE%97%E6%B3%95%E7%9A%84%E5%9F%BA%E6%9C%AC%E8%BF%87%E7%A8%8B"><span class="toc-number">1.2.1.</span> <span class="toc-text"> RSA算法的基本过程</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E5%AF%86%E9%92%A5%E4%BA%A7%E7%94%9F%E8%BF%87%E7%A8%8B"><span class="toc-number">1.2.2.</span> <span class="toc-text"> 密钥产生过程</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#rsa%E7%9A%84%E4%BD%BF%E7%94%A8"><span class="toc-number">1.2.3.</span> <span class="toc-text"> RSA的使用</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E4%B8%BA%E4%BB%80%E4%B9%88rsa%E5%8F%AF%E4%BB%A5%E5%8A%A0%E8%A7%A3%E5%AF%86"><span class="toc-number">1.2.4.</span> <span class="toc-text"> 为什么RSA可以加解密？</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#rsa%E5%AF%86%E9%92%A5key%E7%9A%84%E9%80%89%E6%8B%A9"><span class="toc-number">1.2.5.</span> <span class="toc-text"> RSA密钥key的选择</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#rsa%E7%9A%84%E5%AE%89%E5%85%A8%E6%80%A7"><span class="toc-number">1.2.6.</span> <span class="toc-text"> RSA的安全性</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#rsa%E5%85%AC%E9%92%A5%E4%BD%93%E8%B4%A8%E7%9A%84%E5%AE%89%E5%85%A8%E6%80%A7%E6%98%AF%E5%BB%BA%E7%AB%8B%E5%9C%A8%E5%93%AA%E7%A7%8D%E4%BA%8B%E5%AE%9E%E4%B9%8B%E4%B8%8A"><span class="toc-number">1.2.7.</span> <span class="toc-text"> RSA公钥体质的安全性是建立在哪种事实之上？</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E9%80%89%E6%8B%A9%E5%AF%86%E6%96%87cca"><span class="toc-number">1.2.8.</span> <span class="toc-text"> 选择密文CCA</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#diffie-hellman-%E5%AF%86%E9%92%A5%E4%BA%A4%E6%8D%A2%E5%8D%8F%E8%AE%AE"><span class="toc-number">1.3.</span> <span class="toc-text"> Diffie-Hellman 密钥交换协议</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#diffie-hellman-%E5%AF%86%E9%92%A5%E4%BA%A4%E6%8D%A2%E7%AE%97%E6%B3%95"><span class="toc-number">1.3.1.</span> <span class="toc-text"> Diffie-Hellman 密钥交换算法</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#diffie-hellman%E7%AE%97%E6%B3%95%E4%B8%AD%E5%AD%98%E5%9C%A8%E7%9A%84%E9%97%AE%E9%A2%98"><span class="toc-number">1.3.2.</span> <span class="toc-text"> Diffie-Hellman算法中存在的问题</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#ecc%E6%A4%AD%E5%9C%86%E8%AE%A1%E7%AE%97"><span class="toc-number">1.4.</span> <span class="toc-text"> ECC椭圆计算</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#hash%E4%B8%8Emac%E9%83%A8%E5%88%86"><span class="toc-number">1.5.</span> <span class="toc-text"> Hash与MAC部分</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E8%AE%A4%E8%AF%81%E6%8A%80%E6%9C%AF"><span class="toc-number">1.6.</span> <span class="toc-text"> 认证技术</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#%E6%8A%A5%E6%96%87%E8%AE%A4%E8%AF%81mac"><span class="toc-number">1.6.1.</span> <span class="toc-text"> 报文认证MAC</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E5%AE%9E%E4%BD%93%E8%AE%A4%E8%AF%81-%E7%94%A8%E6%88%B7%E8%AE%A4%E8%AF%81"><span class="toc-number">1.6.2.</span> <span class="toc-text"> 实体认证 – 用户认证</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E6%8A%A5%E6%96%87%E8%AE%A4%E8%AF%81"><span class="toc-number">1.6.3.</span> <span class="toc-text"> 报文认证</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#mac%E7%9A%84%E5%AE%89%E5%85%A8%E6%80%A7%E9%9C%80%E6%B1%82"><span class="toc-number">1.6.4.</span> <span class="toc-text"> MAC的安全性需求</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E6%95%B0%E5%AD%97%E7%AD%BE%E5%90%8D"><span class="toc-number">1.7.</span> <span class="toc-text"> 数字签名</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#%E6%95%B0%E5%AD%97%E7%AD%BE%E5%90%8D%E5%BA%94%E5%85%B7%E6%9C%89%E7%9A%84%E6%80%A7%E8%B4%A8"><span class="toc-number">1.7.0.1.</span> <span class="toc-text"> 数字签名应具有的性质</span></a></li></ol></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E8%AE%A4%E8%AF%81%E7%B3%BB%E7%BB%9F"><span class="toc-number">1.8.</span> <span class="toc-text"> 认证系统</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#%E8%AF%81%E4%B9%A6"><span class="toc-number">1.8.1.</span> <span class="toc-text"> 证书</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#pki-public-key-infrastructure-%E5%85%AC%E9%92%A5%E5%9F%BA%E7%A1%80%E8%AE%BE%E6%96%BD"><span class="toc-number">1.8.2.</span> <span class="toc-text"> PKI Public Key Infrastructure 公钥基础设施</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#%E8%AE%A4%E8%AF%81%E6%9C%BA%E6%9E%84ca%E7%B3%BB%E7%BB%9F"><span class="toc-number">1.8.2.1.</span> <span class="toc-text"> 认证机构CA系统</span></a></li></ol></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E8%AE%A4%E8%AF%81%E5%8D%8F%E8%AE%AE"><span class="toc-number">1.9.</span> <span class="toc-text"> 认证协议</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#%E5%BC%B1%E8%AE%A4%E8%AF%81"><span class="toc-number">1.9.1.</span> <span class="toc-text"> 弱认证</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E5%BC%BA%E8%AE%A4%E8%AF%81"><span class="toc-number">1.9.2.</span> <span class="toc-text"> 强认证</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E5%AE%89%E5%85%A8%E7%AD%96%E7%95%A5%E8%AE%BF%E9%97%AE%E6%8E%A7%E5%88%B6"><span class="toc-number">1.10.</span> <span class="toc-text"> 安全策略，访问控制</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#%E5%AE%89%E5%85%A8%E7%AD%96%E7%95%A5"><span class="toc-number">1.10.1.</span> <span class="toc-text"> 安全策略</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E5%AE%89%E5%85%A8%E7%B3%BB%E7%BB%9F"><span class="toc-number">1.10.2.</span> <span class="toc-text"> 安全系统</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#%E5%AE%9A%E4%B9%89%E4%B8%80"><span class="toc-number">1.10.2.1.</span> <span class="toc-text"> 定义一</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E5%AE%9A%E4%B9%89%E4%BA%8C"><span class="toc-number">1.10.2.2.</span> <span class="toc-text"> 定义二</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E5%AE%9A%E4%B9%89%E4%B8%89"><span class="toc-number">1.10.2.3.</span> <span class="toc-text"> 定义三</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E5%AE%9A%E4%B9%89%E5%9B%9B"><span class="toc-number">1.10.2.4.</span> <span class="toc-text"> 定义四</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E5%AE%9A%E4%B9%89%E4%BA%94"><span class="toc-number">1.10.2.5.</span> <span class="toc-text"> 定义五</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E5%AE%9A%E4%B9%89%E5%85%AD"><span class="toc-number">1.10.2.6.</span> <span class="toc-text"> 定义六</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E5%AE%9A%E4%B9%89%E4%B8%83"><span class="toc-number">1.10.2.7.</span> <span class="toc-text"> 定义七</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E4%B8%A4%E4%B8%AA%E7%BB%93%E8%AE%BA"><span class="toc-number">1.10.2.8.</span> <span class="toc-text"> 两个结论</span></a></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E8%AE%BF%E9%97%AE%E6%8E%A7%E5%88%B6"><span class="toc-number">1.10.3.</span> <span class="toc-text"> 访问控制</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#%E8%AE%BF%E9%97%AE%E6%8E%A7%E5%88%B6%E7%AD%96%E7%95%A5"><span class="toc-number">1.10.3.1.</span> <span class="toc-text"> 访问控制策略</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E8%AE%BF%E9%97%AE%E6%8E%A7%E5%88%B6%E7%9A%84%E5%9F%BA%E6%9C%AC%E5%85%83%E7%B4%A0"><span class="toc-number">1.10.3.2.</span> <span class="toc-text"> 访问控制的基本元素</span></a></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E8%87%AA%E4%B8%BB%E8%AE%BF%E9%97%AE%E6%8E%A7%E5%88%B6"><span class="toc-number">1.10.4.</span> <span class="toc-text"> 自主访问控制</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E5%BC%BA%E5%88%B6%E6%80%A7%E8%AE%BF%E9%97%AE%E6%8E%A7%E5%88%B6"><span class="toc-number">1.10.5.</span> <span class="toc-text"> 强制性访问控制</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#blp%E6%A8%A1%E5%9E%8B"><span class="toc-number">1.10.5.1.</span> <span class="toc-text"> BLP模型</span></a></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E5%9F%BA%E4%BA%8E%E8%A7%92%E8%89%B2%E7%9A%84%E8%AE%BF%E9%97%AE%E6%8E%A7%E5%88%B6"><span class="toc-number">1.10.6.</span> <span class="toc-text"> 基于角色的访问控制</span></a></li></ol></li></ol></li></ol></div></div><div class="author-info hide"><div class="author-info__avatar text-center"><img src="/touxiang.jpg"></div><div class="author-info__name text-center">luo</div><div class="author-info__description text-center">在一群优秀的人中间，常常以为自己是他们一员，然后忘了努力</div><hr><div class="author-info-articles"><a class="author-info-articles__archives article-meta" href="/archives"><span class="pull-left">文章</span><span class="pull-right">24</span></a><a class="author-info-articles__tags article-meta" href="/tags"><span class="pull-left">标签</span><span class="pull-right">22</span></a><a class="author-info-articles__categories article-meta" href="/categories"><span class="pull-left">分类</span><span class="pull-right">4</span></a></div><hr><div class="author-info-links"><div class="author-info-links__title text-center">友情链接</div><a class="author-info-links__name text-center" target="_blank" rel="noopener" href="https://m0d1.top">mod1</a><a class="author-info-links__name text-center" target="_blank" rel="noopener" href="https://c10udlnk.top">c10udlnk</a><a class="author-info-links__name text-center" target="_blank" rel="noopener" href="https://www.fxizenta.design/">Fxizenta</a><a class="author-info-links__name text-center" target="_blank" rel="noopener" href="https://mclaren888.cn">Mclaren</a><a class="author-info-links__name text-center" target="_blank" rel="noopener" href="https://dzcgood.xyz/">DzcGood</a><a class="author-info-links__name text-center" target="_blank" rel="noopener" href="https://imcomma.top/">imcomma</a><a class="author-info-links__name text-center" target="_blank" rel="noopener" href="https://csomepro.github.io/">Csome</a><a class="author-info-links__name text-center" target="_blank" rel="noopener" href="https://joevic.top/">Joe</a></div></div></div><div id="content-outer"><div id="top-container" style="background-image: url(/background2.jpg)"><div id="page-header"><span class="pull-left"> <a id="site-name" href="/">luo's Blog</a></span><i class="fa fa-bars toggle-menu pull-right" aria-hidden="true"></i><span class="pull-right menus">   <a class="site-page" href="/">luo</a><a class="site-page" href="/archives">时间线</a><a class="site-page" href="/tags">标签</a><a class="site-page" href="/categories">分类</a></span><span class="pull-right"><a class="site-page social-icon search"><i class="fa fa-search"></i><span> 搜索</span></a></span></div><div id="post-info"><div id="post-title">ComSec概念概述</div><div id="post-meta"><time class="post-meta__date"><i class="fa fa-calendar" aria-hidden="true"></i> 2022-01-20</time><span class="post-meta__separator">|</span><i class="fa fa-inbox post-meta__icon" aria-hidden="true"></i><a class="post-meta__categories" href="/categories/%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0/">学习笔记</a><div class="post-meta-wordcount"><span>字数总计: </span><span class="word-count">7.8k</span><span class="post-meta__separator">|</span><span>阅读时长: 25 分钟</span></div></div></div></div><div class="layout" id="content-inner"><article id="post"><div class="article-container" id="post-content"><h1 id="comsec总结"><a class="markdownIt-Anchor" href="#comsec总结"></a> ComSec总结</h1>
<p>这学期选修了bintou老师的ComSec计算机安全课，上课期间觉得自己学的马马虎虎的，学习了一些计算机安全中的密码学算法和安全概念，但对这些概念都不是特别清晰，期末复习的过程中，对其中的一些算法和概念更理解了一些，趁着刚考完还没忘记，总结一波挂在博客，不当之处，欢迎指正。</p>
<h2 id="公钥密码学概述"><a class="markdownIt-Anchor" href="#公钥密码学概述"></a> 公钥密码学概述</h2>
<p>公钥密码学也称为<strong>非对称密码学</strong>，与传统的对称密码学区别在于，加密和解密使用<strong>不同的密钥</strong>，也就是所说的<strong>key</strong>，其中公开出来的密钥是<strong>公钥</strong>，另一个是私钥，由持有者<strong>严格保密</strong>。且<strong>公钥密码</strong>是基于数学函数而不是基于替换和置换。</p>
<p>公钥密码学提出的解决的基本问题包括有</p>
<ol>
<li>密钥交换</li>
<li>数字签名</li>
</ol>
<p>公钥密码的六个组成成分分别是<strong>明文</strong>，<strong>密文</strong>，<strong>公钥</strong>，<strong>私钥</strong>，<strong>加密算法</strong>，<strong>解密算法</strong>。</p>
<span id="more"></span>
<p>公钥密码的重要特点是</p>
<ul>
<li>仅根据密码算法和加密密钥，确定解密密钥在<strong>计算上不可行</strong>，所谓计算上不可行即是<code>解决一个问题所需要的时间比输入规模的多项式增长更快，如输入长度为n位，计算复杂度是</code><span class="katex"><span class="katex-mathml"><math><semantics><mrow><msup><mn>2</mn><mi>n</mi></msup></mrow><annotation encoding="application/x-tex">2^{n}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.664392em;vertical-align:0em;"></span><span class="mord"><span class="mord">2</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.664392em;"><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathdefault mtight">n</span></span></span></span></span></span></span></span></span></span></span></span>。</li>
<li>两个密钥中的任意一个都可用来加密，另一个用来解密，也就是说，存在两个方式，一种是<code>公钥加密，私钥解密</code>，一种是<code>私钥加密，公钥解密</code>。根据这两种方式，公钥密码体制分成了两个模式，一个是<strong>加密模式</strong>，一个是<strong>认证模式</strong>。</li>
</ul>
<h3 id="加密模式"><a class="markdownIt-Anchor" href="#加密模式"></a> 加密模式</h3>
<p>所谓<strong>加密模式</strong>，也就是用<code>公钥加密，私钥解密</code>的模式。</p>
<p>加密模式的运行过程如下，A向B发消息X，已知B的公钥为<span class="katex"><span class="katex-mathml"><math><semantics><mrow><msub><mi>K</mi><mrow><mi>U</mi><mi>b</mi></mrow></msub></mrow><annotation encoding="application/x-tex">K_{Ub}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.83333em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord mathdefault" style="margin-right:0.07153em;">K</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.33610799999999996em;"><span style="top:-2.5500000000000003em;margin-left:-0.07153em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathdefault mtight" style="margin-right:0.10903em;">U</span><span class="mord mathdefault mtight">b</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span>，私钥为<span class="katex"><span class="katex-mathml"><math><semantics><mrow><msub><mi>K</mi><mrow><mi>R</mi><mi>b</mi></mrow></msub></mrow><annotation encoding="application/x-tex">K_{Rb}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.83333em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord mathdefault" style="margin-right:0.07153em;">K</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.33610799999999996em;"><span style="top:-2.5500000000000003em;margin-left:-0.07153em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathdefault mtight" style="margin-right:0.00773em;">R</span><span class="mord mathdefault mtight">b</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span>，加密算法为E，解密算法为D，则加密过程为<span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>Y</mi><mo>=</mo><msub><mi>E</mi><msub><mi>K</mi><mrow><mi>U</mi><mi>b</mi></mrow></msub></msub><mo stretchy="false">(</mo><mi>X</mi><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">Y=E_{K_{Ub}}(X)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.68333em;vertical-align:0em;"></span><span class="mord mathdefault" style="margin-right:0.22222em;">Y</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:1.00586em;vertical-align:-0.25586em;"></span><span class="mord"><span class="mord mathdefault" style="margin-right:0.05764em;">E</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.32833099999999993em;"><span style="top:-2.55em;margin-left:-0.05764em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight"><span class="mord mathdefault mtight" style="margin-right:0.07153em;">K</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3448em;"><span style="top:-2.3487714285714287em;margin-left:-0.07153em;margin-right:0.07142857142857144em;"><span class="pstrut" style="height:2.5em;"></span><span class="sizing reset-size3 size1 mtight"><span class="mord mtight"><span class="mord mathdefault mtight" style="margin-right:0.10903em;">U</span><span class="mord mathdefault mtight">b</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15122857142857138em;"><span></span></span></span></span></span></span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.25586em;"><span></span></span></span></span></span></span><span class="mopen">(</span><span class="mord mathdefault" style="margin-right:0.07847em;">X</span><span class="mclose">)</span></span></span></span>，解密过程<span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>X</mi><mo>=</mo><msub><mi>D</mi><msub><mi>K</mi><mrow><mi>R</mi><mi>b</mi></mrow></msub></msub><mo stretchy="false">(</mo><mi>Y</mi><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">X=D_{K_{Rb}}(Y)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.68333em;vertical-align:0em;"></span><span class="mord mathdefault" style="margin-right:0.07847em;">X</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:1.00586em;vertical-align:-0.25586em;"></span><span class="mord"><span class="mord mathdefault" style="margin-right:0.02778em;">D</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.32833099999999993em;"><span style="top:-2.55em;margin-left:-0.02778em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight"><span class="mord mathdefault mtight" style="margin-right:0.07153em;">K</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3448em;"><span style="top:-2.3487714285714287em;margin-left:-0.07153em;margin-right:0.07142857142857144em;"><span class="pstrut" style="height:2.5em;"></span><span class="sizing reset-size3 size1 mtight"><span class="mord mtight"><span class="mord mathdefault mtight" style="margin-right:0.00773em;">R</span><span class="mord mathdefault mtight">b</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15122857142857138em;"><span></span></span></span></span></span></span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.25586em;"><span></span></span></span></span></span></span><span class="mopen">(</span><span class="mord mathdefault" style="margin-right:0.22222em;">Y</span><span class="mclose">)</span></span></span></span>。之所以能够保证<strong>传递消息是保密的</strong>，是因为只有<code>私钥才可以解密</code>，而私钥只有B持有。所以所有想给B发消息的人，只需要用B的公钥和对应的加密算法对消息进行加密即可，而加密的消息只有B能解，保证了<strong>消息的保密性</strong>。</p>
<h3 id="认证模式"><a class="markdownIt-Anchor" href="#认证模式"></a> 认证模式</h3>
<p>所谓<strong>认证模式</strong>，也就是用<code>私钥加密，公钥解密</code>的模式。</p>
<p>认证模式的运行过程如下，A向B发消息，已经A的公钥为<span class="katex"><span class="katex-mathml"><math><semantics><mrow><msub><mi>K</mi><mrow><mi>U</mi><mi>a</mi></mrow></msub></mrow><annotation encoding="application/x-tex">K_{Ua}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.83333em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord mathdefault" style="margin-right:0.07153em;">K</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.32833099999999993em;"><span style="top:-2.5500000000000003em;margin-left:-0.07153em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathdefault mtight" style="margin-right:0.10903em;">U</span><span class="mord mathdefault mtight">a</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span>，A的私钥为<span class="katex"><span class="katex-mathml"><math><semantics><mrow><msub><mi>K</mi><mrow><mi>R</mi><mi>a</mi></mrow></msub></mrow><annotation encoding="application/x-tex">K_{Ra}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.83333em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord mathdefault" style="margin-right:0.07153em;">K</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.32833099999999993em;"><span style="top:-2.5500000000000003em;margin-left:-0.07153em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathdefault mtight" style="margin-right:0.00773em;">R</span><span class="mord mathdefault mtight">a</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span>，加密算法为E，解密算法为D，则加密过程为<span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>Y</mi><mo>=</mo><msub><mi>E</mi><msub><mi>K</mi><mrow><mi>R</mi><mi>a</mi></mrow></msub></msub><mo stretchy="false">(</mo><mi>X</mi><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">Y=E_{K_{Ra}}(X)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.68333em;vertical-align:0em;"></span><span class="mord mathdefault" style="margin-right:0.22222em;">Y</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:1.000305em;vertical-align:-0.250305em;"></span><span class="mord"><span class="mord mathdefault" style="margin-right:0.05764em;">E</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.32833099999999993em;"><span style="top:-2.5500000000000003em;margin-left:-0.05764em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight"><span class="mord mathdefault mtight" style="margin-right:0.07153em;">K</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3448em;"><span style="top:-2.3567071428571427em;margin-left:-0.07153em;margin-right:0.07142857142857144em;"><span class="pstrut" style="height:2.5em;"></span><span class="sizing reset-size3 size1 mtight"><span class="mord mtight"><span class="mord mathdefault mtight" style="margin-right:0.00773em;">R</span><span class="mord mathdefault mtight">a</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.14329285714285717em;"><span></span></span></span></span></span></span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.250305em;"><span></span></span></span></span></span></span><span class="mopen">(</span><span class="mord mathdefault" style="margin-right:0.07847em;">X</span><span class="mclose">)</span></span></span></span>，解密过程为<span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>X</mi><mo>=</mo><msub><mi>D</mi><msub><mi>K</mi><mrow><mi>U</mi><mi>a</mi></mrow></msub></msub><mo stretchy="false">(</mo><mi>Y</mi><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">X=D_{K_{Ua}}(Y)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.68333em;vertical-align:0em;"></span><span class="mord mathdefault" style="margin-right:0.07847em;">X</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:1.000305em;vertical-align:-0.250305em;"></span><span class="mord"><span class="mord mathdefault" style="margin-right:0.02778em;">D</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.32833099999999993em;"><span style="top:-2.5500000000000003em;margin-left:-0.02778em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight"><span class="mord mathdefault mtight" style="margin-right:0.07153em;">K</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3448em;"><span style="top:-2.3567071428571427em;margin-left:-0.07153em;margin-right:0.07142857142857144em;"><span class="pstrut" style="height:2.5em;"></span><span class="sizing reset-size3 size1 mtight"><span class="mord mtight"><span class="mord mathdefault mtight" style="margin-right:0.10903em;">U</span><span class="mord mathdefault mtight">a</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.14329285714285717em;"><span></span></span></span></span></span></span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.250305em;"><span></span></span></span></span></span></span><span class="mopen">(</span><span class="mord mathdefault" style="margin-right:0.22222em;">Y</span><span class="mclose">)</span></span></span></span>，注意这里虽然说的是加密算法和解密算法，但是<strong>认证模式</strong>下并不能保证消息的保密性，因为只要知道A的公钥的人就可以解出明文，而公钥又是公开的，所以并不能提供消息的保密性，那么认证模式是来干嘛的呢？认证模式<strong>只有私钥能加密</strong>，借助这个<strong>唯一加密</strong>的特性，可以实现数字签名，私钥就相当于你的<strong>字迹</strong>，别人无法模仿的，别人一看到这个字迹就知道是你写的，就相当于别人用公钥验证私钥，验证成功，知道消息是你发的，提供了<strong>认证性</strong>。</p>
<h3 id="同时具有保密与认证的公钥体质"><a class="markdownIt-Anchor" href="#同时具有保密与认证的公钥体质"></a> 同时具有保密与认证的公钥体质</h3>
<p>那么如果我们传送消息时，想要同时有<strong>加密</strong>和<strong>认证</strong>两种需求，如何做呢？很简单，就是用两对公私钥对，一对采用<strong>加密模式</strong>，一对才用<strong>认证模式</strong>。</p>
<p>假定A向B发消息，A的密钥对为{<span class="katex"><span class="katex-mathml"><math><semantics><mrow><msub><mi>K</mi><mrow><mi>U</mi><mi>a</mi></mrow></msub></mrow><annotation encoding="application/x-tex">K_{Ua}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.83333em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord mathdefault" style="margin-right:0.07153em;">K</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.32833099999999993em;"><span style="top:-2.5500000000000003em;margin-left:-0.07153em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathdefault mtight" style="margin-right:0.10903em;">U</span><span class="mord mathdefault mtight">a</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span>，<span class="katex"><span class="katex-mathml"><math><semantics><mrow><msub><mi>K</mi><mrow><mi>R</mi><mi>a</mi></mrow></msub></mrow><annotation encoding="application/x-tex">K_{Ra}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.83333em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord mathdefault" style="margin-right:0.07153em;">K</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.32833099999999993em;"><span style="top:-2.5500000000000003em;margin-left:-0.07153em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathdefault mtight" style="margin-right:0.00773em;">R</span><span class="mord mathdefault mtight">a</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span>}，B的密钥对为{<span class="katex"><span class="katex-mathml"><math><semantics><mrow><msub><mi>K</mi><mrow><mi>U</mi><mi>b</mi></mrow></msub></mrow><annotation encoding="application/x-tex">K_{Ub}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.83333em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord mathdefault" style="margin-right:0.07153em;">K</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.33610799999999996em;"><span style="top:-2.5500000000000003em;margin-left:-0.07153em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathdefault mtight" style="margin-right:0.10903em;">U</span><span class="mord mathdefault mtight">b</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span>，<span class="katex"><span class="katex-mathml"><math><semantics><mrow><msub><mi>K</mi><mrow><mi>R</mi><mi>a</mi></mrow></msub></mrow><annotation encoding="application/x-tex">K_{Ra}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.83333em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord mathdefault" style="margin-right:0.07153em;">K</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.32833099999999993em;"><span style="top:-2.5500000000000003em;margin-left:-0.07153em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathdefault mtight" style="margin-right:0.00773em;">R</span><span class="mord mathdefault mtight">a</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span>}，A要求发的消息同时具有<strong>加密性</strong>和<strong>认证性</strong>，怎么做呢？</p>
<p>首先是加密性，加密性需要用<code>公钥加密，私钥解密</code>，用谁的公钥呢？B的，因为B要查看消息，所以B要用自己的私钥去解密消息，所以A就用B的公钥去加密要传送的消息。<strong>认证</strong>需要用私钥加密，用谁的私钥呢？A的，因为B要确认消息是A所发出的，所以用A的私钥对消息进行加密，B收到消息后用解密算法进行验证，实现认证。</p>
<p>整个过程如下：假定发送的<strong>明文为X</strong></p>
<p>首先用B的公钥对消息进行加密<span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>Z</mi><mo>=</mo><msub><mi>E</mi><msub><mi>K</mi><mrow><mi>U</mi><mi>b</mi></mrow></msub></msub><mo stretchy="false">(</mo><mi>X</mi><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">Z=E_{K_{Ub}}(X)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.68333em;vertical-align:0em;"></span><span class="mord mathdefault" style="margin-right:0.07153em;">Z</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:1.00586em;vertical-align:-0.25586em;"></span><span class="mord"><span class="mord mathdefault" style="margin-right:0.05764em;">E</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.32833099999999993em;"><span style="top:-2.55em;margin-left:-0.05764em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight"><span class="mord mathdefault mtight" style="margin-right:0.07153em;">K</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3448em;"><span style="top:-2.3487714285714287em;margin-left:-0.07153em;margin-right:0.07142857142857144em;"><span class="pstrut" style="height:2.5em;"></span><span class="sizing reset-size3 size1 mtight"><span class="mord mtight"><span class="mord mathdefault mtight" style="margin-right:0.10903em;">U</span><span class="mord mathdefault mtight">b</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15122857142857138em;"><span></span></span></span></span></span></span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.25586em;"><span></span></span></span></span></span></span><span class="mopen">(</span><span class="mord mathdefault" style="margin-right:0.07847em;">X</span><span class="mclose">)</span></span></span></span>，这一步实现的是<strong>加密</strong>，然后再执行<span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>Y</mi><mo>=</mo><msub><mi>E</mi><msub><mi>K</mi><mrow><mi>R</mi><mi>a</mi></mrow></msub></msub><mo stretchy="false">(</mo><mi>Z</mi><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">Y=E_{K_{Ra}}(Z)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.68333em;vertical-align:0em;"></span><span class="mord mathdefault" style="margin-right:0.22222em;">Y</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:1.000305em;vertical-align:-0.250305em;"></span><span class="mord"><span class="mord mathdefault" style="margin-right:0.05764em;">E</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.32833099999999993em;"><span style="top:-2.5500000000000003em;margin-left:-0.05764em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight"><span class="mord mathdefault mtight" style="margin-right:0.07153em;">K</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3448em;"><span style="top:-2.3567071428571427em;margin-left:-0.07153em;margin-right:0.07142857142857144em;"><span class="pstrut" style="height:2.5em;"></span><span class="sizing reset-size3 size1 mtight"><span class="mord mtight"><span class="mord mathdefault mtight" style="margin-right:0.00773em;">R</span><span class="mord mathdefault mtight">a</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.14329285714285717em;"><span></span></span></span></span></span></span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.250305em;"><span></span></span></span></span></span></span><span class="mopen">(</span><span class="mord mathdefault" style="margin-right:0.07153em;">Z</span><span class="mclose">)</span></span></span></span>，这一步实现的是<strong>认证</strong>，然后将密文Y传送给B，B收到Y后首先做<span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>Z</mi><mo>=</mo><msub><mi>D</mi><msub><mi>K</mi><mrow><mi>U</mi><mi>a</mi></mrow></msub></msub><mo stretchy="false">(</mo><mi>Y</mi><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">Z=D_{K_{Ua}}(Y)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.68333em;vertical-align:0em;"></span><span class="mord mathdefault" style="margin-right:0.07153em;">Z</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:1.000305em;vertical-align:-0.250305em;"></span><span class="mord"><span class="mord mathdefault" style="margin-right:0.02778em;">D</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.32833099999999993em;"><span style="top:-2.5500000000000003em;margin-left:-0.02778em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight"><span class="mord mathdefault mtight" style="margin-right:0.07153em;">K</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3448em;"><span style="top:-2.3567071428571427em;margin-left:-0.07153em;margin-right:0.07142857142857144em;"><span class="pstrut" style="height:2.5em;"></span><span class="sizing reset-size3 size1 mtight"><span class="mord mtight"><span class="mord mathdefault mtight" style="margin-right:0.10903em;">U</span><span class="mord mathdefault mtight">a</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.14329285714285717em;"><span></span></span></span></span></span></span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.250305em;"><span></span></span></span></span></span></span><span class="mopen">(</span><span class="mord mathdefault" style="margin-right:0.22222em;">Y</span><span class="mclose">)</span></span></span></span>解出Z，然后执行<span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>X</mi><mo>=</mo><msub><mi>D</mi><msub><mi>K</mi><mrow><mi>R</mi><mi>b</mi></mrow></msub></msub><mo stretchy="false">(</mo><mi>Z</mi><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">X=D_{K_{Rb}}(Z)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.68333em;vertical-align:0em;"></span><span class="mord mathdefault" style="margin-right:0.07847em;">X</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:1.00586em;vertical-align:-0.25586em;"></span><span class="mord"><span class="mord mathdefault" style="margin-right:0.02778em;">D</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.32833099999999993em;"><span style="top:-2.55em;margin-left:-0.02778em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight"><span class="mord mathdefault mtight" style="margin-right:0.07153em;">K</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3448em;"><span style="top:-2.3487714285714287em;margin-left:-0.07153em;margin-right:0.07142857142857144em;"><span class="pstrut" style="height:2.5em;"></span><span class="sizing reset-size3 size1 mtight"><span class="mord mtight"><span class="mord mathdefault mtight" style="margin-right:0.00773em;">R</span><span class="mord mathdefault mtight">b</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15122857142857138em;"><span></span></span></span></span></span></span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.25586em;"><span></span></span></span></span></span></span><span class="mopen">(</span><span class="mord mathdefault" style="margin-right:0.07153em;">Z</span><span class="mclose">)</span></span></span></span>解出明文X，实现了<strong>加密</strong>和<strong>认证</strong>。</p>
<h3 id="公钥密码体制应满足的要求"><a class="markdownIt-Anchor" href="#公钥密码体制应满足的要求"></a> 公钥密码体制应满足的要求</h3>
<p>公钥密文体制的运行也需要一些要求</p>
<p><code>一般要求：</code></p>
<ol>
<li>加密解密算法相同，但使用密钥不同</li>
<li>发送方拥有加密或解密密钥，而接收方拥有另一个密钥。</li>
</ol>
<p><code>安全性要求</code>：</p>
<ol>
<li>两个密钥之一必须保密，<strong>作为私钥</strong></li>
<li>无解密密钥，解密不可行</li>
<li>知道算法和其中一个密钥，以及若干个密文不能确定另一个密文。</li>
</ol>
<h3 id="关于公钥密码的几种误解"><a class="markdownIt-Anchor" href="#关于公钥密码的几种误解"></a> 关于公钥密码的几种误解</h3>
<ol>
<li>
<p>公钥密码比传统密码更安全？</p>
<p>任何加密算法的<strong>安全性</strong>依赖于<strong>密钥的长度</strong>和<strong>破译密文所需要的计算量</strong>。从抗密码分析的角度来看，原则上不能说传统密码优于公钥密码，而不能说公钥密码优于传统密码。</p>
</li>
<li>
<p>公钥密码是通用方法，所以传统密码已经过时？</p>
<p>其实恰恰相反，由于现有的公钥密码方法所需的<strong>计算量大</strong>，取缔传统密码似乎不太可能，仅限用在<strong>密钥管理</strong>和<strong>签名</strong>这类应用上。</p>
</li>
<li>
<p>公钥密码实现密钥分配非常简单？</p>
<p>事实上，使用公钥密码也需要某种形式的<strong>协议</strong>，该协议通常包含一个<strong>中心代理</strong>，并且它的处理过程也不比传统密码中的那些过程简单和有效。</p>
</li>
</ol>
<h2 id="rsa"><a class="markdownIt-Anchor" href="#rsa"></a> RSA</h2>
<p>RSA公开密钥密码体制是最著名且被广泛使用的公开密钥密码体制。</p>
<h3 id="rsa算法的基本过程"><a class="markdownIt-Anchor" href="#rsa算法的基本过程"></a> RSA算法的基本过程</h3>
<p>首先，明文和密文是0~n-1之间的整数，通常n的大小为1024位或309位十进制。</p>
<p><code>RSA算法描述</code></p>
<p><strong>加密</strong>：<span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>C</mi><mo>=</mo><msup><mi>M</mi><mi>e</mi></msup><mtext> </mtext><mi>m</mi><mi>o</mi><mi>d</mi><mtext> </mtext><mi>N</mi></mrow><annotation encoding="application/x-tex">C=M^{e} \ mod \ N</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.68333em;vertical-align:0em;"></span><span class="mord mathdefault" style="margin-right:0.07153em;">C</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:0.69444em;vertical-align:0em;"></span><span class="mord"><span class="mord mathdefault" style="margin-right:0.10903em;">M</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.664392em;"><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathdefault mtight">e</span></span></span></span></span></span></span></span></span><span class="mspace"> </span><span class="mord mathdefault">m</span><span class="mord mathdefault">o</span><span class="mord mathdefault">d</span><span class="mspace"> </span><span class="mord mathdefault" style="margin-right:0.10903em;">N</span></span></span></span>  where 0&lt;= M &lt; N</p>
<p><strong>解密</strong>：$M=C^{d} mod \ N \ $</p>
<p>公钥为(e,N)，私钥为(d,N)。</p>
<p>必须满足的以下条件</p>
<ol>
<li>
<p><span class="katex"><span class="katex-mathml"><math><semantics><mrow><msup><mi>M</mi><mrow><mi>e</mi><mi>d</mi></mrow></msup><mo>≡</mo><mi>M</mi><mtext> </mtext><mi>m</mi><mi>o</mi><mi>d</mi><mtext> </mtext><mi>N</mi></mrow><annotation encoding="application/x-tex">M^{ed} ≡ M \ mod \ N</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.849108em;vertical-align:0em;"></span><span class="mord"><span class="mord mathdefault" style="margin-right:0.10903em;">M</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.849108em;"><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathdefault mtight">e</span><span class="mord mathdefault mtight">d</span></span></span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">≡</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:0.69444em;vertical-align:0em;"></span><span class="mord mathdefault" style="margin-right:0.10903em;">M</span><span class="mspace"> </span><span class="mord mathdefault">m</span><span class="mord mathdefault">o</span><span class="mord mathdefault">d</span><span class="mspace"> </span><span class="mord mathdefault" style="margin-right:0.10903em;">N</span></span></span></span></p>
</li>
<li>
<p>计算<span class="katex"><span class="katex-mathml"><math><semantics><mrow><msup><mi>M</mi><mi>e</mi></msup></mrow><annotation encoding="application/x-tex">M^{e}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.68333em;vertical-align:0em;"></span><span class="mord"><span class="mord mathdefault" style="margin-right:0.10903em;">M</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.664392em;"><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathdefault mtight">e</span></span></span></span></span></span></span></span></span></span></span></span>和<span class="katex"><span class="katex-mathml"><math><semantics><mrow><msup><mi>C</mi><mi>d</mi></msup></mrow><annotation encoding="application/x-tex">C^{d}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.849108em;vertical-align:0em;"></span><span class="mord"><span class="mord mathdefault" style="margin-right:0.07153em;">C</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.849108em;"><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathdefault mtight">d</span></span></span></span></span></span></span></span></span></span></span></span>是比较容易的(<strong>效率</strong>)。</p>
</li>
<li>
<p>由e和n确定d是不可行的(<strong>安全</strong>)。</p>
</li>
</ol>
<h3 id="密钥产生过程"><a class="markdownIt-Anchor" href="#密钥产生过程"></a> 密钥产生过程</h3>
<ol>
<li>
<p>随机选择两个不等的<strong>大素数</strong>p，q</p>
</li>
<li>
<p>计算N=p*q，对应有<span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>ϕ</mi><mo stretchy="false">(</mo><mi>N</mi><mo stretchy="false">)</mo><mo>=</mo><mo stretchy="false">(</mo><mi>p</mi><mo>−</mo><mn>1</mn><mo stretchy="false">)</mo><mo>×</mo><mo stretchy="false">(</mo><mi>q</mi><mo>−</mo><mn>1</mn><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">\phi(N)=(p-1)×(q-1)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathdefault">ϕ</span><span class="mopen">(</span><span class="mord mathdefault" style="margin-right:0.10903em;">N</span><span class="mclose">)</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mopen">(</span><span class="mord mathdefault">p</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">−</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord">1</span><span class="mclose">)</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">×</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mopen">(</span><span class="mord mathdefault" style="margin-right:0.03588em;">q</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">−</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord">1</span><span class="mclose">)</span></span></span></span></p>
</li>
<li>
<p>选择e使得 <span class="katex"><span class="katex-mathml"><math><semantics><mrow><mn>1</mn><mo>&lt;</mo><mi>e</mi><mo>&lt;</mo><mi>ϕ</mi><mo stretchy="false">(</mo><mi>N</mi><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">1&lt;e&lt;\phi(N)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.68354em;vertical-align:-0.0391em;"></span><span class="mord">1</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">&lt;</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:0.5782em;vertical-align:-0.0391em;"></span><span class="mord mathdefault">e</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">&lt;</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathdefault">ϕ</span><span class="mopen">(</span><span class="mord mathdefault" style="margin-right:0.10903em;">N</span><span class="mclose">)</span></span></span></span>，且$gcd(e,\phi(N)) = 1 <span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi mathvariant="normal">（</mi><mi mathvariant="normal">使</mi><mi mathvariant="normal">得</mi><mi>e</mi><mi mathvariant="normal">在</mi></mrow><annotation encoding="application/x-tex">（使得e在</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.43056em;vertical-align:0em;"></span><span class="mord cjk_fallback">（</span><span class="mord cjk_fallback">使</span><span class="mord cjk_fallback">得</span><span class="mord mathdefault">e</span><span class="mord cjk_fallback">在</span></span></span></span>\phi(N)$下存在<strong>逆元</strong>，也就是后面我们要求的d）</p>
</li>
<li>
<p>解下列方程求出d</p>
<p><span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>e</mi><mi>d</mi><mo>≡</mo><mn>1</mn><mtext> </mtext><mi>m</mi><mi>o</mi><mi>d</mi><mtext> </mtext><mi>ϕ</mi><mo stretchy="false">(</mo><mi>N</mi><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">ed ≡ 1 \ mod \ \phi(N)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.69444em;vertical-align:0em;"></span><span class="mord mathdefault">e</span><span class="mord mathdefault">d</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">≡</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord">1</span><span class="mspace"> </span><span class="mord mathdefault">m</span><span class="mord mathdefault">o</span><span class="mord mathdefault">d</span><span class="mspace"> </span><span class="mord mathdefault">ϕ</span><span class="mopen">(</span><span class="mord mathdefault" style="margin-right:0.10903em;">N</span><span class="mclose">)</span></span></span></span>  且 0&lt;= d &lt;= N</p>
</li>
<li>
<p>公布公钥KU={e，N}</p>
</li>
<li>
<p>保存私钥KR={d，N}</p>
</li>
</ol>
<h3 id="rsa的使用"><a class="markdownIt-Anchor" href="#rsa的使用"></a> RSA的使用</h3>
<ol>
<li>发送方加密明文M
<ul>
<li>获取接收方的公钥KU={e,N}</li>
<li>计算$C=M^{e} \ mod \ N $  where 0&lt;= M &lt; N</li>
</ul>
</li>
<li>接收方解密密文C<br>
用自己的私钥KR={d，N}，计算 <span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>M</mi><mo>=</mo><msup><mi>C</mi><mi>d</mi></msup><mtext> </mtext><mi>m</mi><mi>o</mi><mi>d</mi><mtext> </mtext><mi>N</mi></mrow><annotation encoding="application/x-tex">M=C^{d} \ mod \ N</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.68333em;vertical-align:0em;"></span><span class="mord mathdefault" style="margin-right:0.10903em;">M</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:0.849108em;vertical-align:0em;"></span><span class="mord"><span class="mord mathdefault" style="margin-right:0.07153em;">C</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.849108em;"><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathdefault mtight">d</span></span></span></span></span></span></span></span></span><span class="mspace"> </span><span class="mord mathdefault">m</span><span class="mord mathdefault">o</span><span class="mord mathdefault">d</span><span class="mspace"> </span><span class="mord mathdefault" style="margin-right:0.10903em;">N</span></span></span></span></li>
</ol>
<h3 id="为什么rsa可以加解密"><a class="markdownIt-Anchor" href="#为什么rsa可以加解密"></a> 为什么RSA可以加解密？</h3>
<p>由<strong>欧拉定理</strong>：</p>
<blockquote>
<p>欧拉定理：设n和a为正整数，且gcd(a,n) = 1，则 <span class="katex"><span class="katex-mathml"><math><semantics><mrow><msup><mi>a</mi><mrow><mi>ϕ</mi><mo stretchy="false">(</mo><mi>n</mi><mo stretchy="false">)</mo></mrow></msup><mo>≡</mo><mn>1</mn><mtext> </mtext><mo stretchy="false">(</mo><mi>m</mi><mi>o</mi><mi>d</mi><mtext> </mtext><mi>n</mi><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">a^{\phi(n)} ≡ 1\ (mod \ n)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.8879999999999999em;vertical-align:0em;"></span><span class="mord"><span class="mord mathdefault">a</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.8879999999999999em;"><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathdefault mtight">ϕ</span><span class="mopen mtight">(</span><span class="mord mathdefault mtight">n</span><span class="mclose mtight">)</span></span></span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">≡</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord">1</span><span class="mspace"> </span><span class="mopen">(</span><span class="mord mathdefault">m</span><span class="mord mathdefault">o</span><span class="mord mathdefault">d</span><span class="mspace"> </span><span class="mord mathdefault">n</span><span class="mclose">)</span></span></span></span></p>
</blockquote>
<p>又在RSA ：<span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>e</mi><mi>d</mi><mo>≡</mo><mn>1</mn><mtext> </mtext><mi>m</mi><mi>o</mi><mi>d</mi><mtext> </mtext><mi>ϕ</mi><mo stretchy="false">(</mo><mi>N</mi><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">ed ≡ 1 \ mod \ \phi(N)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.69444em;vertical-align:0em;"></span><span class="mord mathdefault">e</span><span class="mord mathdefault">d</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">≡</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord">1</span><span class="mspace"> </span><span class="mord mathdefault">m</span><span class="mord mathdefault">o</span><span class="mord mathdefault">d</span><span class="mspace"> </span><span class="mord mathdefault">ϕ</span><span class="mopen">(</span><span class="mord mathdefault" style="margin-right:0.10903em;">N</span><span class="mclose">)</span></span></span></span>，等价于<span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>e</mi><mi>d</mi><mo>=</mo><mi>k</mi><mi>ϕ</mi><mo stretchy="false">(</mo><mi>N</mi><mo stretchy="false">)</mo><mo>+</mo><mn>1</mn></mrow><annotation encoding="application/x-tex">ed=k\phi(N)+1</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.69444em;vertical-align:0em;"></span><span class="mord mathdefault">e</span><span class="mord mathdefault">d</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathdefault" style="margin-right:0.03148em;">k</span><span class="mord mathdefault">ϕ</span><span class="mopen">(</span><span class="mord mathdefault" style="margin-right:0.10903em;">N</span><span class="mclose">)</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span></span><span class="base"><span class="strut" style="height:0.64444em;vertical-align:0em;"></span><span class="mord">1</span></span></span></span></p>
<p>所以$M^{ed} ≡ M \ mod \ N $</p>
<p>等价于 <span class="katex"><span class="katex-mathml"><math><semantics><mrow><msup><mi>M</mi><mrow><mi>k</mi><mi>ϕ</mi><mo stretchy="false">(</mo><mi>N</mi><mo stretchy="false">)</mo><mo>+</mo><mn>1</mn></mrow></msup><mo>≡</mo><mi>M</mi><mtext> </mtext><mi>m</mi><mi>o</mi><mi>d</mi><mtext> </mtext><mi>N</mi></mrow><annotation encoding="application/x-tex">M^{k\phi(N)+1} ≡ M \ mod \ N</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.8879999999999999em;vertical-align:0em;"></span><span class="mord"><span class="mord mathdefault" style="margin-right:0.10903em;">M</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.8879999999999999em;"><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathdefault mtight" style="margin-right:0.03148em;">k</span><span class="mord mathdefault mtight">ϕ</span><span class="mopen mtight">(</span><span class="mord mathdefault mtight" style="margin-right:0.10903em;">N</span><span class="mclose mtight">)</span><span class="mbin mtight">+</span><span class="mord mtight">1</span></span></span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">≡</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:0.69444em;vertical-align:0em;"></span><span class="mord mathdefault" style="margin-right:0.10903em;">M</span><span class="mspace"> </span><span class="mord mathdefault">m</span><span class="mord mathdefault">o</span><span class="mord mathdefault">d</span><span class="mspace"> </span><span class="mord mathdefault" style="margin-right:0.10903em;">N</span></span></span></span></p>
<p>在RSA中 N=p×q，p,q为素数，所以有<span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>ϕ</mi><mo stretchy="false">(</mo><mi>N</mi><mo stretchy="false">)</mo><mo>=</mo><mo stretchy="false">(</mo><mi>p</mi><mo>−</mo><mn>1</mn><mo stretchy="false">)</mo><mo>×</mo><mo stretchy="false">(</mo><mi>q</mi><mo>−</mo><mn>1</mn><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">\phi(N)=(p-1)×(q-1)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathdefault">ϕ</span><span class="mopen">(</span><span class="mord mathdefault" style="margin-right:0.10903em;">N</span><span class="mclose">)</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mopen">(</span><span class="mord mathdefault">p</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">−</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord">1</span><span class="mclose">)</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">×</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mopen">(</span><span class="mord mathdefault" style="margin-right:0.03588em;">q</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">−</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord">1</span><span class="mclose">)</span></span></span></span></p>
<p>且 <span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>e</mi><mi>d</mi><mo>≡</mo><mn>1</mn><mtext> </mtext><mi>m</mi><mi>o</mi><mi>d</mi><mtext> </mtext><mi>ϕ</mi><mo stretchy="false">(</mo><mi>N</mi><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">ed ≡ 1 \ mod \ \phi(N)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.69444em;vertical-align:0em;"></span><span class="mord mathdefault">e</span><span class="mord mathdefault">d</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">≡</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord">1</span><span class="mspace"> </span><span class="mord mathdefault">m</span><span class="mord mathdefault">o</span><span class="mord mathdefault">d</span><span class="mspace"> </span><span class="mord mathdefault">ϕ</span><span class="mopen">(</span><span class="mord mathdefault" style="margin-right:0.10903em;">N</span><span class="mclose">)</span></span></span></span></p>
<p>因此，有<span class="katex"><span class="katex-mathml"><math><semantics><mrow><msup><mi>C</mi><mi>d</mi></msup><mo>≡</mo><mo stretchy="false">(</mo><msup><mi>M</mi><mi>e</mi></msup><msup><mo stretchy="false">)</mo><mi>d</mi></msup><mo>=</mo><msup><mi>M</mi><mrow><mi>e</mi><mi>d</mi></mrow></msup><mo>≡</mo><mi>M</mi><mtext> </mtext><mi>m</mi><mi>o</mi><mi>d</mi><mtext> </mtext><mi>N</mi><mo>=</mo><mi>M</mi></mrow><annotation encoding="application/x-tex">C^{d}≡ (M^{e})^{d}=M^{ed} ≡ M \ mod \ N = M</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.849108em;vertical-align:0em;"></span><span class="mord"><span class="mord mathdefault" style="margin-right:0.07153em;">C</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.849108em;"><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathdefault mtight">d</span></span></span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">≡</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:1.099108em;vertical-align:-0.25em;"></span><span class="mopen">(</span><span class="mord"><span class="mord mathdefault" style="margin-right:0.10903em;">M</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.664392em;"><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathdefault mtight">e</span></span></span></span></span></span></span></span></span><span class="mclose"><span class="mclose">)</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.849108em;"><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathdefault mtight">d</span></span></span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:0.849108em;vertical-align:0em;"></span><span class="mord"><span class="mord mathdefault" style="margin-right:0.10903em;">M</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.849108em;"><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathdefault mtight">e</span><span class="mord mathdefault mtight">d</span></span></span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">≡</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:0.69444em;vertical-align:0em;"></span><span class="mord mathdefault" style="margin-right:0.10903em;">M</span><span class="mspace"> </span><span class="mord mathdefault">m</span><span class="mord mathdefault">o</span><span class="mord mathdefault">d</span><span class="mspace"> </span><span class="mord mathdefault" style="margin-right:0.10903em;">N</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:0.68333em;vertical-align:0em;"></span><span class="mord mathdefault" style="margin-right:0.10903em;">M</span></span></span></span></p>
<h3 id="rsa密钥key的选择"><a class="markdownIt-Anchor" href="#rsa密钥key的选择"></a> RSA密钥key的选择</h3>
<p>从安全性考虑，key的选择需要以下规则</p>
<ol>
<li>p和q不能太接近</li>
<li>p-1 和 q-1必须包含大的素因子</li>
<li>gcd(q-1,p-1)必须小</li>
<li>e和d不能太小，e可选65537</li>
<li>d不能小于<span class="katex"><span class="katex-mathml"><math><semantics><mrow><msup><mi>n</mi><mrow><mn>1</mn><mi mathvariant="normal">/</mi><mn>4</mn></mrow></msup></mrow><annotation encoding="application/x-tex">n^{1/4}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.8879999999999999em;vertical-align:0em;"></span><span class="mord"><span class="mord mathdefault">n</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.8879999999999999em;"><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">1</span><span class="mord mtight">/</span><span class="mord mtight">4</span></span></span></span></span></span></span></span></span></span></span></span></li>
</ol>
<h3 id="rsa的安全性"><a class="markdownIt-Anchor" href="#rsa的安全性"></a> RSA的安全性</h3>
<ul>
<li>
<p>强力穷举攻击：<strong>穷举</strong>所有可能的私钥</p>
</li>
<li>
<p>数学攻击：实质是对两个素数的乘积N的分解，由N求得<span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>ϕ</mi><mo stretchy="false">(</mo><mi>N</mi><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">\phi(N)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathdefault">ϕ</span><span class="mopen">(</span><span class="mord mathdefault" style="margin-right:0.10903em;">N</span><span class="mclose">)</span></span></span></span>是困难的，因此要将N分解为p和q两个质数，然后利用<span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>ϕ</mi><mo stretchy="false">(</mo><mi>N</mi><mo stretchy="false">)</mo><mo>=</mo><mo stretchy="false">(</mo><mi>p</mi><mo>−</mo><mn>1</mn><mo stretchy="false">)</mo><mo>∗</mo><mo stretchy="false">(</mo><mi>q</mi><mo>−</mo><mn>1</mn><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">\phi(N)=(p-1)*(q-1)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathdefault">ϕ</span><span class="mopen">(</span><span class="mord mathdefault" style="margin-right:0.10903em;">N</span><span class="mclose">)</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mopen">(</span><span class="mord mathdefault">p</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">−</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord">1</span><span class="mclose">)</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">∗</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mopen">(</span><span class="mord mathdefault" style="margin-right:0.03588em;">q</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">−</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord">1</span><span class="mclose">)</span></span></span></span></p>
</li>
<li>
<p>时间攻击 ：不懂</p>
</li>
<li>
<p><strong>选择密文攻击CCA</strong></p>
</li>
</ul>
<p>三种数学攻击方法</p>
<ol>
<li>
<p>分解N=p*q，由此可算出<span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>ϕ</mi><mo stretchy="false">(</mo><mi>N</mi><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">\phi(N)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathdefault">ϕ</span><span class="mopen">(</span><span class="mord mathdefault" style="margin-right:0.10903em;">N</span><span class="mclose">)</span></span></span></span>，从而确定d</p>
</li>
<li>
<p>直接确定<span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>ϕ</mi><mo stretchy="false">(</mo><mi>N</mi><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">\phi(N)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathdefault">ϕ</span><span class="mopen">(</span><span class="mord mathdefault" style="margin-right:0.10903em;">N</span><span class="mclose">)</span></span></span></span>，然后找到d</p>
</li>
<li>
<p>直接确定d</p>
<p>本质上都是要找到<span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>ϕ</mi><mo stretchy="false">(</mo><mi>N</mi><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">\phi(N)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathdefault">ϕ</span><span class="mopen">(</span><span class="mord mathdefault" style="margin-right:0.10903em;">N</span><span class="mclose">)</span></span></span></span>或直接找到d，由<code>N确定$\phi(N)$可等价于因子分解</code>。</p>
</li>
</ol>
<h3 id="rsa公钥体质的安全性是建立在哪种事实之上"><a class="markdownIt-Anchor" href="#rsa公钥体质的安全性是建立在哪种事实之上"></a> RSA公钥体质的安全性是建立在哪种事实之上？</h3>
<p><strong>因子分解</strong>具有大素数因子的数仍然是一个难题。</p>
<h3 id="选择密文cca"><a class="markdownIt-Anchor" href="#选择密文cca"></a> 选择密文CCA</h3>
<p>选择密文攻击是假定攻击者有一台<strong>解密机</strong>，除了待解的密文，攻击者可以输入任意的密文，然后解密机就会给出对应的明文，因此攻击者可以构造特殊的密文，去求解出<strong>待解的密文</strong>。</p>
<p>给定待解密文<span class="katex"><span class="katex-mathml"><math><semantics><mrow><msup><mi>C</mi><mo>∗</mo></msup></mrow><annotation encoding="application/x-tex">C^{*}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.688696em;vertical-align:0em;"></span><span class="mord"><span class="mord mathdefault" style="margin-right:0.07153em;">C</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.688696em;"><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">∗</span></span></span></span></span></span></span></span></span></span></span></span>，求对应的明文<span class="katex"><span class="katex-mathml"><math><semantics><mrow><msup><mi>M</mi><mo>∗</mo></msup></mrow><annotation encoding="application/x-tex">M^{*}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.688696em;vertical-align:0em;"></span><span class="mord"><span class="mord mathdefault" style="margin-right:0.10903em;">M</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.688696em;"><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">∗</span></span></span></span></span></span></span></span></span></span></span></span>，并给出一个解密机O</p>
<p><strong>攻击过程</strong>：</p>
<p>构造密文<span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>C</mi><mo>=</mo><msup><mn>2</mn><mi>e</mi></msup><msup><mi>C</mi><mo>∗</mo></msup></mrow><annotation encoding="application/x-tex">C=2^{e}C^{*}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.68333em;vertical-align:0em;"></span><span class="mord mathdefault" style="margin-right:0.07153em;">C</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:0.688696em;vertical-align:0em;"></span><span class="mord"><span class="mord">2</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.664392em;"><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathdefault mtight">e</span></span></span></span></span></span></span></span></span><span class="mord"><span class="mord mathdefault" style="margin-right:0.07153em;">C</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.688696em;"><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">∗</span></span></span></span></span></span></span></span></span></span></span></span></p>
<p>将C输入到解密机O，得到对应的明文M</p>
<p><span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>M</mi><mo>=</mo><mo stretchy="false">(</mo><msup><mi>C</mi><mi>d</mi></msup><mtext> </mtext><mi>m</mi><mi>o</mi><mi>d</mi><mtext> </mtext><mi>N</mi><mo stretchy="false">)</mo><mo>=</mo><mo stretchy="false">(</mo><msup><mn>2</mn><mi>e</mi></msup><msup><mi>C</mi><mo>∗</mo></msup><msup><mo stretchy="false">)</mo><mi>d</mi></msup><mtext> </mtext><mi>m</mi><mi>o</mi><mi>d</mi><mtext> </mtext><mi>N</mi><mo>=</mo><msup><mn>2</mn><mrow><mi>e</mi><mi>d</mi></mrow></msup><msup><mi>C</mi><mrow><mo>∗</mo><mi>d</mi></mrow></msup><mtext> </mtext><mi>m</mi><mi>o</mi><mi>d</mi><mtext> </mtext><mi>N</mi><mo>=</mo><mn>2</mn><mo>∗</mo><msup><mi>m</mi><mo>∗</mo></msup><mtext> </mtext><mi>m</mi><mi>o</mi><mi>d</mi><mtext> </mtext><mi>N</mi><mo>=</mo><mn>2</mn><msup><mi>m</mi><mo>∗</mo></msup></mrow><annotation encoding="application/x-tex">M=(C^{d} \ mod \ N)=(2^{e}C^{*})^{d} \ mod \ N = 2^{ed}C^{*d} \ mod \ N = 2* m^{*} \ mod \ N = 2m^{*}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.68333em;vertical-align:0em;"></span><span class="mord mathdefault" style="margin-right:0.10903em;">M</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:1.099108em;vertical-align:-0.25em;"></span><span class="mopen">(</span><span class="mord"><span class="mord mathdefault" style="margin-right:0.07153em;">C</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.849108em;"><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathdefault mtight">d</span></span></span></span></span></span></span></span></span><span class="mspace"> </span><span class="mord mathdefault">m</span><span class="mord mathdefault">o</span><span class="mord mathdefault">d</span><span class="mspace"> </span><span class="mord mathdefault" style="margin-right:0.10903em;">N</span><span class="mclose">)</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:1.099108em;vertical-align:-0.25em;"></span><span class="mopen">(</span><span class="mord"><span class="mord">2</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.664392em;"><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathdefault mtight">e</span></span></span></span></span></span></span></span></span><span class="mord"><span class="mord mathdefault" style="margin-right:0.07153em;">C</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.688696em;"><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">∗</span></span></span></span></span></span></span></span></span><span class="mclose"><span class="mclose">)</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.849108em;"><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathdefault mtight">d</span></span></span></span></span></span></span></span></span><span class="mspace"> </span><span class="mord mathdefault">m</span><span class="mord mathdefault">o</span><span class="mord mathdefault">d</span><span class="mspace"> </span><span class="mord mathdefault" style="margin-right:0.10903em;">N</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:0.849108em;vertical-align:0em;"></span><span class="mord"><span class="mord">2</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.849108em;"><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathdefault mtight">e</span><span class="mord mathdefault mtight">d</span></span></span></span></span></span></span></span></span><span class="mord"><span class="mord mathdefault" style="margin-right:0.07153em;">C</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.849108em;"><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">∗</span><span class="mord mathdefault mtight">d</span></span></span></span></span></span></span></span></span><span class="mspace"> </span><span class="mord mathdefault">m</span><span class="mord mathdefault">o</span><span class="mord mathdefault">d</span><span class="mspace"> </span><span class="mord mathdefault" style="margin-right:0.10903em;">N</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:0.64444em;vertical-align:0em;"></span><span class="mord">2</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">∗</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span></span><span class="base"><span class="strut" style="height:0.69444em;vertical-align:0em;"></span><span class="mord"><span class="mord mathdefault">m</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.688696em;"><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">∗</span></span></span></span></span></span></span></span></span><span class="mspace"> </span><span class="mord mathdefault">m</span><span class="mord mathdefault">o</span><span class="mord mathdefault">d</span><span class="mspace"> </span><span class="mord mathdefault" style="margin-right:0.10903em;">N</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:0.688696em;vertical-align:0em;"></span><span class="mord">2</span><span class="mord"><span class="mord mathdefault">m</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.688696em;"><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">∗</span></span></span></span></span></span></span></span></span></span></span></span></p>
<p>于是便可以求得<span class="katex"><span class="katex-mathml"><math><semantics><mrow><msup><mi>m</mi><mo>∗</mo></msup></mrow><annotation encoding="application/x-tex">m^{*}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.688696em;vertical-align:0em;"></span><span class="mord"><span class="mord mathdefault">m</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.688696em;"><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">∗</span></span></span></span></span></span></span></span></span></span></span></span></p>
<h2 id="diffie-hellman-密钥交换协议"><a class="markdownIt-Anchor" href="#diffie-hellman-密钥交换协议"></a> Diffie-Hellman 密钥交换协议</h2>
<p>Diffie-Hellman需要原根(生成元)的定义</p>
<p><code>原根</code>：如果a是素数p的原根，则数 a mod p,<span class="katex"><span class="katex-mathml"><math><semantics><mrow><msup><mi>a</mi><mn>2</mn></msup><mtext> </mtext><mi>m</mi><mi>o</mi><mi>d</mi><mtext> </mtext><mi>p</mi></mrow><annotation encoding="application/x-tex">a^{2} \ mod \ p</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1.008548em;vertical-align:-0.19444em;"></span><span class="mord"><span class="mord mathdefault">a</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.8141079999999999em;"><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">2</span></span></span></span></span></span></span></span></span><span class="mspace"> </span><span class="mord mathdefault">m</span><span class="mord mathdefault">o</span><span class="mord mathdefault">d</span><span class="mspace"> </span><span class="mord mathdefault">p</span></span></span></span> … <span class="katex"><span class="katex-mathml"><math><semantics><mrow><msup><mi>a</mi><mrow><mi>p</mi><mo>−</mo><mn>1</mn></mrow></msup><mtext> </mtext><mi>m</mi><mi>o</mi><mi>d</mi><mtext> </mtext><mi>p</mi></mrow><annotation encoding="application/x-tex">a^{p-1} \ mod \ p</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1.008548em;vertical-align:-0.19444em;"></span><span class="mord"><span class="mord mathdefault">a</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.8141079999999999em;"><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathdefault mtight">p</span><span class="mbin mtight">−</span><span class="mord mtight">1</span></span></span></span></span></span></span></span></span><span class="mspace"> </span><span class="mord mathdefault">m</span><span class="mord mathdefault">o</span><span class="mord mathdefault">d</span><span class="mspace"> </span><span class="mord mathdefault">p</span></span></span></span>是不同的并且包含1到p-1的整数的<strong>某种排列</strong>。原根是数论的概念。</p>
<p><code>生成元</code>：p为素数，g是<span class="katex"><span class="katex-mathml"><math><semantics><mrow><msubsup><mi>Z</mi><mi>p</mi><mo>∗</mo></msubsup></mrow><annotation encoding="application/x-tex">Z_{p}^{*}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1.071804em;vertical-align:-0.383108em;"></span><span class="mord"><span class="mord mathdefault" style="margin-right:0.07153em;">Z</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.688696em;"><span style="top:-2.4530000000000003em;margin-left:-0.07153em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathdefault mtight">p</span></span></span></span><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">∗</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.383108em;"><span></span></span></span></span></span></span></span></span></span>的生成元，当且仅当g的阶是p-1. 生成元是<strong>群论的概念</strong>。</p>
<p>Diffie-Hellman公钥体制</p>
<p>目标：Alice和Bob试图在公开网络上通过交互建立一个<strong>秘密</strong></p>
<h3 id="diffie-hellman-密钥交换算法"><a class="markdownIt-Anchor" href="#diffie-hellman-密钥交换算法"></a> Diffie-Hellman 密钥交换算法</h3>
<p><code>全局公开量：</code></p>
<ul>
<li>大素数：p</li>
<li>选g为<span class="katex"><span class="katex-mathml"><math><semantics><mrow><msubsup><mi>Z</mi><mi>p</mi><mo>∗</mo></msubsup></mrow><annotation encoding="application/x-tex">Z_{p}^{*}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1.071804em;vertical-align:-0.383108em;"></span><span class="mord"><span class="mord mathdefault" style="margin-right:0.07153em;">Z</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.688696em;"><span style="top:-2.4530000000000003em;margin-left:-0.07153em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathdefault mtight">p</span></span></span></span><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">∗</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.383108em;"><span></span></span></span></span></span></span></span></span></span>的生成元</li>
</ul>
<p><code>Alice密钥的产生</code>：</p>
<p>选择随机数x&lt;p</p>
<p>计算公开量 <span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>X</mi><mo>=</mo><msup><mi>g</mi><mi>x</mi></msup><mtext> </mtext><mi>m</mi><mi>o</mi><mi>d</mi><mtext> </mtext><mi>p</mi></mrow><annotation encoding="application/x-tex">X=g^{x} \ mod \ p</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.68333em;vertical-align:0em;"></span><span class="mord mathdefault" style="margin-right:0.07847em;">X</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:0.8888799999999999em;vertical-align:-0.19444em;"></span><span class="mord"><span class="mord mathdefault" style="margin-right:0.03588em;">g</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.664392em;"><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathdefault mtight">x</span></span></span></span></span></span></span></span></span><span class="mspace"> </span><span class="mord mathdefault">m</span><span class="mord mathdefault">o</span><span class="mord mathdefault">d</span><span class="mspace"> </span><span class="mord mathdefault">p</span></span></span></span></p>
<p><code>Bob密钥的产生</code>：</p>
<p>选择随机数y&lt;p</p>
<p>计算公开量<span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>Y</mi><mo>=</mo><msup><mi>g</mi><mi>y</mi></msup><mtext> </mtext><mi>m</mi><mi>o</mi><mi>d</mi><mtext> </mtext><mi>p</mi></mrow><annotation encoding="application/x-tex">Y=g^{y}\ mod \ p</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.68333em;vertical-align:0em;"></span><span class="mord mathdefault" style="margin-right:0.22222em;">Y</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:0.8888799999999999em;vertical-align:-0.19444em;"></span><span class="mord"><span class="mord mathdefault" style="margin-right:0.03588em;">g</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.664392em;"><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathdefault mtight" style="margin-right:0.03588em;">y</span></span></span></span></span></span></span></span></span><span class="mspace"> </span><span class="mord mathdefault">m</span><span class="mord mathdefault">o</span><span class="mord mathdefault">d</span><span class="mspace"> </span><span class="mord mathdefault">p</span></span></span></span></p>
<p><code>协议过程</code>：</p>
<p>Alice -----&gt; Bob:X</p>
<p>Bob -------&gt; Alice：Y</p>
<p><code>产生密钥</code>：</p>
<p>Alice接受到了Y，计算<span class="katex"><span class="katex-mathml"><math><semantics><mrow><msub><mi>K</mi><mrow><mi>A</mi><mi>B</mi></mrow></msub><mo>=</mo><msup><mi>Y</mi><mi>x</mi></msup><mtext> </mtext><mi>m</mi><mi>o</mi><mi>d</mi><mtext> </mtext><mi>q</mi></mrow><annotation encoding="application/x-tex">K_{AB}=Y^{x} \ mod \ q</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.83333em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord mathdefault" style="margin-right:0.07153em;">K</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.32833099999999993em;"><span style="top:-2.5500000000000003em;margin-left:-0.07153em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathdefault mtight">A</span><span class="mord mathdefault mtight" style="margin-right:0.05017em;">B</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:0.8888799999999999em;vertical-align:-0.19444em;"></span><span class="mord"><span class="mord mathdefault" style="margin-right:0.22222em;">Y</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.664392em;"><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathdefault mtight">x</span></span></span></span></span></span></span></span></span><span class="mspace"> </span><span class="mord mathdefault">m</span><span class="mord mathdefault">o</span><span class="mord mathdefault">d</span><span class="mspace"> </span><span class="mord mathdefault" style="margin-right:0.03588em;">q</span></span></span></span></p>
<p>Bob接受到了X，计算<span class="katex"><span class="katex-mathml"><math><semantics><mrow><msub><mi>K</mi><mrow><mi>A</mi><mi>B</mi></mrow></msub><mo>=</mo><msup><mi>X</mi><mi>y</mi></msup><mtext> </mtext><mi>m</mi><mi>o</mi><mi>d</mi><mtext> </mtext><mi>q</mi></mrow><annotation encoding="application/x-tex">K_{AB}=X^{y}\ mod \ q</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.83333em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord mathdefault" style="margin-right:0.07153em;">K</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.32833099999999993em;"><span style="top:-2.5500000000000003em;margin-left:-0.07153em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathdefault mtight">A</span><span class="mord mathdefault mtight" style="margin-right:0.05017em;">B</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:0.8888799999999999em;vertical-align:-0.19444em;"></span><span class="mord"><span class="mord mathdefault" style="margin-right:0.07847em;">X</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.664392em;"><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathdefault mtight" style="margin-right:0.03588em;">y</span></span></span></span></span></span></span></span></span><span class="mspace"> </span><span class="mord mathdefault">m</span><span class="mord mathdefault">o</span><span class="mord mathdefault">d</span><span class="mspace"> </span><span class="mord mathdefault" style="margin-right:0.03588em;">q</span></span></span></span></p>
<p><span class="katex"><span class="katex-mathml"><math><semantics><mrow><msub><mi>K</mi><mrow><mi>A</mi><mi>B</mi></mrow></msub><mo>=</mo><msup><mi>g</mi><mrow><mi>x</mi><mi>y</mi></mrow></msup><mtext> </mtext><mi>m</mi><mi>o</mi><mi>d</mi><mtext> </mtext><mi>q</mi></mrow><annotation encoding="application/x-tex">K_{AB}=g^{xy}\ mod \ q</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.83333em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord mathdefault" style="margin-right:0.07153em;">K</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.32833099999999993em;"><span style="top:-2.5500000000000003em;margin-left:-0.07153em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathdefault mtight">A</span><span class="mord mathdefault mtight" style="margin-right:0.05017em;">B</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:0.8888799999999999em;vertical-align:-0.19444em;"></span><span class="mord"><span class="mord mathdefault" style="margin-right:0.03588em;">g</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.664392em;"><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathdefault mtight">x</span><span class="mord mathdefault mtight" style="margin-right:0.03588em;">y</span></span></span></span></span></span></span></span></span><span class="mspace"> </span><span class="mord mathdefault">m</span><span class="mord mathdefault">o</span><span class="mord mathdefault">d</span><span class="mspace"> </span><span class="mord mathdefault" style="margin-right:0.03588em;">q</span></span></span></span></p>
<p>这样双方就都计算出了密钥<span class="katex"><span class="katex-mathml"><math><semantics><mrow><msub><mi>K</mi><mrow><mi>A</mi><mi>B</mi></mrow></msub></mrow><annotation encoding="application/x-tex">K_{AB}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.83333em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord mathdefault" style="margin-right:0.07153em;">K</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.32833099999999993em;"><span style="top:-2.5500000000000003em;margin-left:-0.07153em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathdefault mtight">A</span><span class="mord mathdefault mtight" style="margin-right:0.05017em;">B</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span>，成功完成了密钥的交换，且<strong>各自的私钥x和y没有暴露</strong>。</p>
<p>为什么没有暴露呢？因为传递的是X和Y，而Diffie-Hellman密钥的安全性正是建立在如下的事实上：<code>求关于素数的模幂运算相对容易，而计算离散对数问题却非常困难，对于大素数，求离散对数问题被认为是计算上不可行的</code></p>
<blockquote>
<p>离散对数问题：给定<span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>y</mi><mo>=</mo><msup><mi>g</mi><mi>x</mi></msup><mtext> </mtext><mi>m</mi><mi>o</mi><mi>d</mi><mtext> </mtext><mi>p</mi></mrow><annotation encoding="application/x-tex">y=g^{x} \ mod \ p</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.625em;vertical-align:-0.19444em;"></span><span class="mord mathdefault" style="margin-right:0.03588em;">y</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:0.8888799999999999em;vertical-align:-0.19444em;"></span><span class="mord"><span class="mord mathdefault" style="margin-right:0.03588em;">g</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.664392em;"><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathdefault mtight">x</span></span></span></span></span></span></span></span></span><span class="mspace"> </span><span class="mord mathdefault">m</span><span class="mord mathdefault">o</span><span class="mord mathdefault">d</span><span class="mspace"> </span><span class="mord mathdefault">p</span></span></span></span>，知道y,g,p，求x在计算上是不可行的，如果p是一个大素数</p>
</blockquote>
<p>正因如此，双方才能在各自私钥不暴露的情况下完成密钥(<span class="katex"><span class="katex-mathml"><math><semantics><mrow><msub><mi>K</mi><mrow><mi>A</mi><mi>B</mi></mrow></msub></mrow><annotation encoding="application/x-tex">K_{AB}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.83333em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord mathdefault" style="margin-right:0.07153em;">K</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.32833099999999993em;"><span style="top:-2.5500000000000003em;margin-left:-0.07153em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathdefault mtight">A</span><span class="mord mathdefault mtight" style="margin-right:0.05017em;">B</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span>)的交换。</p>
<h3 id="diffie-hellman算法中存在的问题"><a class="markdownIt-Anchor" href="#diffie-hellman算法中存在的问题"></a> Diffie-Hellman算法中存在的问题</h3>
<p>Diffie-Hellman算法中存在的问题就是<strong>不能对抗中间人攻击</strong>。</p>
<p><code>中间人攻击原理如下</code>：</p>
<img src="/2022/01/20/ComSec%E8%AE%A1%E7%AE%97%E6%9C%BA%E5%AE%89%E5%85%A8OverView/1.png" style="zoom: 25%;">
<p>那么如何对抗中间人攻击呢？之所以存在中间人攻击，是因为Diffie-Hellman没有对通信的参与方<strong>进行认证</strong>，所以引入<strong>认证</strong>机制可以抵抗中间人攻击，如何引入<strong>认证机制</strong>？就要用到我们前面提到的公钥密码的认证模式，具体的应用为<strong>数字签名</strong>，通过添加<strong>数字签名</strong>对通信的参与方进行认证，从而对抗中间人攻击。</p>
<h2 id="ecc椭圆计算"><a class="markdownIt-Anchor" href="#ecc椭圆计算"></a> ECC椭圆计算</h2>
<p>只是一个只会在<span class="katex"><span class="katex-mathml"><math><semantics><mrow><msub><mi>Z</mi><mi>p</mi></msub></mrow><annotation encoding="application/x-tex">Z_{p}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.969438em;vertical-align:-0.286108em;"></span><span class="mord"><span class="mord mathdefault" style="margin-right:0.07153em;">Z</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.15139200000000003em;"><span style="top:-2.5500000000000003em;margin-left:-0.07153em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathdefault mtight">p</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.286108em;"><span></span></span></span></span></span></span></span></span></span>上计算的做题家罢了。</p>
<h2 id="hash与mac部分"><a class="markdownIt-Anchor" href="#hash与mac部分"></a> Hash与MAC部分</h2>
<p><code>Hash函数</code>：Hash函数不是加密解密函数，只是<strong>保证消息的完整性</strong>，在密码学中具有重要的理论和应用价值。</p>
<p><code>Hash函数的定义</code></p>
<ol>
<li>Hash函数是将<strong>任意长度</strong>的报文<strong>映射</strong>成一个<strong>较短的定长</strong>输出报文的函数。</li>
<li>如下形式 h=H(M)，M是边长的报文，h是定长的Hash值。</li>
<li>Hash函数的目的是为文件，报文或其他的分组数据产生<strong>数字指纹</strong>，通过检查“数字指纹”判断消息有没有被篡改过，从而判断<strong>消息的完整性</strong>。</li>
</ol>
<p><code>对Hash函数的要求：</code></p>
<ol>
<li>能用于任何大小的数据分组</li>
<li>H产生定长输出</li>
<li>对任意给定的x，H(x)要相对<strong>易于计算</strong>，使得软硬件实现都变得可行。</li>
</ol>
<p><code>安全性需求</code>：</p>
<ol>
<li>
<p><strong>单向性</strong>：对任意给定的码y，寻求x使得H(x)=y <strong>在计算上不可行</strong></p>
</li>
<li>
<p><strong>弱抗碰撞性</strong>：任意分组x，寻求不等于x的x’，使得H(x)=H(x’)<strong>在计算上不可行</strong></p>
</li>
<li>
<p><strong>强抗碰撞性</strong>：寻求任何的(x，x’)，使得H(x)=H(x’)<strong>在计算上不可行</strong></p>
</li>
</ol>
<p><code>密码学Hash函数的应用</code></p>
<ol>
<li>
<p><strong>消息认证</strong>：验证消息<strong>完整性</strong>的一种机制或服务。确保收到的数据确实和发送时一样，即没有发生第三方截获了消息，进行修改，插入，删除或重放。此外，通常还要求消息认证机制确保&quot;<strong>发送方声称的身份是真实有效的</strong>&quot;，Hash函数用于提供消息认证功能时，Hash值也称为<strong>消息摘要</strong>。更一般地，消息认证是通过<strong>消息认证码MAC</strong>实现的，MAC即<strong>带密钥</strong>的Hash。通信双方基于<strong>共享的同一密钥</strong>来认证彼此交互的消息，就会使用MAC。</p>
<p>总体来看 MAC是<strong>Hash函数和加密函数的集合</strong>,对Hash值保密，防止中间人篡改后轻松地<strong>伪造Hash值</strong>。</p>
</li>
<li>
<p><strong>数字签名</strong>：</p>
<p>Hash函数另一个重要的应用是<strong>数字签名</strong>。数字签名的操作与MAC相似，但MAC防止是第三方的截获和篡改，而数字签名防止的是通信双方自己之间的欺骗(<strong>…全得防着，太可怕了</strong>)。在进行数字签名的过程中，使用用户的<strong>私钥</strong>加密消息的Hash值，其他任何知道该用户<strong>公钥</strong>的人都能够通过数字签名来<strong>验证消息的完整性</strong>。</p>
</li>
</ol>
<h2 id="认证技术"><a class="markdownIt-Anchor" href="#认证技术"></a> 认证技术</h2>
<p>认证是防止<strong>主动攻击</strong>的重要技术，对开放系统的安全性起到重要作用。</p>
<p>认证的主要目的是：</p>
<p>一 <strong>实体认证</strong>(<strong>发送者非冒充</strong>)</p>
<p>二 <strong>报文认证</strong>(验证消息的完整性)</p>
<h3 id="报文认证mac"><a class="markdownIt-Anchor" href="#报文认证mac"></a> 报文认证MAC</h3>
<p>报文认证，简单而言，就是要求接收方可以确保发送方发来的数据具有<strong>真实性</strong>，没有被篡改或是伪造数据。</p>
<p><code>报文认证实例</code></p>
<ul>
<li>在电子商务系统中，在电子政务系统中，我们需要确认某些电子文档不是伪造的。</li>
<li>在实际应用中，我们考虑如何把非法软件与合法软件区分开来。</li>
</ul>
<p><code>特点</code>：第三方可仲裁，离线或者非实时。</p>
<h3 id="实体认证-用户认证"><a class="markdownIt-Anchor" href="#实体认证-用户认证"></a> 实体认证 – 用户认证</h3>
<ul>
<li>确保正在参与通信者是一个非冒充用户，比如QQ,MSN等即时通信系统，邮件系统等</li>
<li>实例：安全登录</li>
<li>特性：实时，在线，多方参与…</li>
</ul>
<h3 id="报文认证"><a class="markdownIt-Anchor" href="#报文认证"></a> 报文认证</h3>
<p>Ailice与Bob共同拥有一个秘密sk，Alice用sk加密M给Bob，Bob解密，立即可知此报文是真假是假。但是这种方法无法防止Alice和Bob之间的相互欺骗，例如Alice否认自己发送过消息，因为Bob也可以伪造Alice给自己发消息，同时Bob也可以否认自己收过某条消息，问题的症状在于Alice与Bob共同拥有<strong>私钥sk</strong>,而后的数字签名就是来解决这个问题的。</p>
<h3 id="mac的安全性需求"><a class="markdownIt-Anchor" href="#mac的安全性需求"></a> MAC的安全性需求</h3>
<ul>
<li>某个报文M的<strong>MAC</strong>必须要短小</li>
<li>要有<strong>认证性</strong>，发送接收双方必须共享<strong>秘密</strong>，看了有些博客，好像也叫<strong>初始信任</strong>，有了初始信任才能有认证。</li>
<li>Hash不足以保证安全</li>
<li>避免“加密运算”</li>
</ul>
<h2 id="数字签名"><a class="markdownIt-Anchor" href="#数字签名"></a> 数字签名</h2>
<p>签名提到了MAC报文认证，MAC理论的遗留问题：要求通信双方首先要共享<strong>秘密</strong>，也称为初始信任，之后才能有认证，双方共享sk，似乎是个很强的要求，但有了<strong>公钥密码体制</strong>(PKC)，这个问题可以得到解决。</p>
<p><code>数字签名是认证的重要工具</code>。</p>
<p><code>为什么需要数字签名</code>：</p>
<p>前面提到了报文认证是用来保护双方之间的数据交换不被第三方侵扰，但它并不能保证<strong>双方自身的相互欺骗</strong>。</p>
<p>实例：</p>
<p>假定A发送一个认证的信息给B，双方之间的争议可能有：</p>
<ul>
<li>B伪造一个不同的消息(<strong>因为B也有sk</strong>)，但声称是从A收到的</li>
<li>A可以否认发过该消息(<strong>因为A可以说是B自己给自己发的</strong>)，B无法证明A确实发了该消息</li>
</ul>
<p>问题的症状在于双方都有<strong>sk</strong>，都可以进行发消息和验证消息，问题在于发送和验证职责的分离。</p>
<p><code>数字签名的直观定义</code>：</p>
<p><strong>目标</strong>：防止报文被伪造，用于保证数据的完整性</p>
<p><strong>操作</strong>：签名者对报文产生一串<strong>公开且他人无法伪造的数据串</strong>，公开是为了给他人验证，无法伪造是保证发送方无法否认发过该消息。</p>
<p>方法：PKC+Hash  PKC用私钥加密，公钥解密，提供认证性，Hash提供消息的完整性。</p>
<h4 id="数字签名应具有的性质"><a class="markdownIt-Anchor" href="#数字签名应具有的性质"></a> 数字签名应具有的性质</h4>
<ul>
<li>必须能够验证签名者以及签名的日期，时间等</li>
<li>必须能够认证签名的报文内容</li>
<li>签名能够由第三方验证，以解决收发双发的争议</li>
</ul>
<h2 id="认证系统"><a class="markdownIt-Anchor" href="#认证系统"></a> 认证系统</h2>
<h3 id="证书"><a class="markdownIt-Anchor" href="#证书"></a> 证书</h3>
<p><code>证书的定义：</code> 公钥 &lt;------&gt; 用户</p>
<p>通俗将：数字证书就是把<code>公钥与其所有者的身份</code>进行<strong>绑定</strong>的文档。</p>
<p>而绑定的方法就是：<code>权威机构(证书颁布机构)CA的数字签名</code>。</p>
<p><code>两个实体</code>：</p>
<ul>
<li>证书用户：使用证书的实体</li>
<li>证书所有者：证书中的主体，证书中公钥的持有者</li>
</ul>
<p><code>证书的格式</code></p>
<ol>
<li>
<p><strong>版本号</strong> Version：区分证书的不同版本</p>
</li>
<li>
<p><strong>证书序列号</strong> Serial number 一个证书，在CA中<strong>唯一标识证书</strong></p>
</li>
<li>
<p><strong>签名算法标识</strong>：带参数的，用于给证书签名的算法</p>
</li>
<li>
<p><strong>发行商名字</strong> Issuer name 创建签名证书的签证机构CA的名字</p>
</li>
<li>
<p><strong>有效期</strong> 生效日期和终止日期</p>
</li>
<li>
<p><strong>证书主体名</strong> 获得证书的用户名，证明拥有相应密钥的主体是公钥的所有者</p>
</li>
<li>
<p><strong>发行商唯一标识</strong></p>
</li>
<li>
<p><strong>证书主体唯一标识</strong></p>
</li>
<li>
<p>…<strong>拓展</strong></p>
</li>
<li>
<p><strong>签名</strong>：用CA私钥对证书的<strong>所有域</strong>及这些域的Hash的值一起加密(<strong>用私钥</strong>)</p>
</li>
</ol>
<h3 id="pki-public-key-infrastructure-公钥基础设施"><a class="markdownIt-Anchor" href="#pki-public-key-infrastructure-公钥基础设施"></a> <code>PKI Public Key Infrastructure</code> 公钥基础设施</h3>
<p>用来提供可靠易用的<strong>公钥密码</strong>操作的<strong>系统的总称</strong>。</p>
<p>主要目标：保障大型开放式网络环境下的网络和信息安全</p>
<p><code>PKI系统的主要组成</code>：</p>
<p><img src="/2022/01/20/ComSec%E8%AE%A1%E7%AE%97%E6%9C%BA%E5%AE%89%E5%85%A8OverView/C:%5CUsers%5CLenovo%5CAppData%5CRoaming%5CTypora%5Ctypora-user-images%5Cimage-20220120144003640.png" alt="image-20220120144003640"></p>
<p><code>PKI系统主要组成</code>：</p>
<ol>
<li><strong>PKI策略</strong> 定义和建立了一个组织信息安全方面的指导方针，同时也定义了密码系统使用的处理方法和原则</li>
<li><strong>认证机构CA(Certificate Authority)系统</strong><br>
PKI的信任基础，它管理了<strong>公钥的整个生命周期</strong>，其作用包括：审计用户身份的RA，发放证书，规定证书的有效期和通过发布证书废除列表确保必要时可以废除证书。</li>
<li><strong>PKI应用</strong><br>
为各种应用提供访问PKI的方式</li>
</ol>
<h4 id="认证机构ca系统"><a class="markdownIt-Anchor" href="#认证机构ca系统"></a> 认证机构CA系统</h4>
<p>PKI的<strong>核心是认证机构CA系统</strong>。</p>
<p>CA系统：</p>
<ol>
<li>权威的，可信任的，公正的第三方机构</li>
<li><strong>认证中心</strong></li>
<li><strong>PKI的核心</strong></li>
<li>数字证书的<strong>签发机构</strong></li>
<li>负责证书的产生，存档，发放，查询，恢复以及作废管理</li>
<li>一个典型的CA系统包括安全服务器，<strong>注册机构RA</strong>，CA服务器，LDAP目录服务器和数据库服务器等。</li>
</ol>
<img src="/2022/01/20/ComSec%E8%AE%A1%E7%AE%97%E6%9C%BA%E5%AE%89%E5%85%A8OverView/2.png" style="zoom: 75%;">
<p><code>注册机构RA</code>：</p>
<ul>
<li>
<p>RA是数字证书<strong>注册审批</strong>机构</p>
</li>
<li>
<p>RA提供用户和CA之间的一个接口，它获取并认证用户的身份，向CA<strong>提出证书请求</strong>，它主要完成<strong>收集用户信息</strong>和<strong>确认用户身份的</strong>功能</p>
</li>
<li>
<p>它接受用户的注册申请，审查用户的申请资格，并决定是否同意CA给其签发数字证书。</p>
</li>
<li>
<p>注：<code>注册机构并不给用户签发证书</code>，而只是对用户进行资格审查。</p>
</li>
</ul>
<p><code>CA的任务</code>：</p>
<ul>
<li>验证并标识证书申请者的身份</li>
<li><strong>签发证书</strong></li>
<li>证书资料信息的管理(<strong>公钥证书序列号，CA标识</strong>)</li>
<li><strong>产生和发布撤销</strong>证书列表</li>
<li>证书的归档</li>
<li>密钥归档与恢复</li>
<li>历史数据归档</li>
</ul>
<p><code>CA的职责</code>：</p>
<ul>
<li>确保CA用于签名证书的非对称密钥的质量</li>
<li>确保整个签证过程的安全性，<strong>确保签名私钥的安全性</strong></li>
<li>确保证书主体标识的唯一性，防止重名</li>
</ul>
<p><code>CA的密钥</code>：</p>
<ul>
<li>是整个证书机制得以运行的基础</li>
<li>CA私钥由CA保管，必须确保<strong>CA私钥的高度机密性</strong></li>
<li>CA公钥在网上公开，必须保证<strong>CA公钥的完整性</strong></li>
</ul>
<p><code>为什么需要PKI</code>?</p>
<p><strong>身份认证</strong>的目的是要确定对方的身份是否是<strong>真实</strong>或<strong>合法的</strong>，为了达到这一目的，需要建立初始信任(双方已经共享了的<strong>秘密</strong>)，但在网络环境下，建立初始信任需要建立一条<strong>安全通道</strong>，这一任务在公钥密码提出之前是非常困难的，代价也很高。而公钥密码提出后，可以用公钥密码手段(<strong>一个公钥，一个私钥，用公钥传递私钥</strong>)传递<strong>秘密</strong>，如Diffie-Hellman。但<strong>公钥的真实性</strong>又难以保证，如何确定一个人和他所持有的公钥的关系，已经公钥是否在有效期内，签名算法是什么？所以<strong>可信的第三方系统</strong>被提了出来，如A与B想建立一条安全路径时，可以寻找共同信任的第三方，在可信第三方的帮助下实现A对B所拥有的<strong>公钥的鉴别</strong>，从而建立初始信任。</p>
<p>而PKI就是这样一个<strong>第三方系统</strong>，可以让可信第三方(<strong>CA</strong>)对用户的公钥<strong>签署证书</strong>，只要验证证书的合法性，就可以相信<strong>公钥证书</strong>中所描述的<strong>关于公钥的信息</strong>，如证书主体，有效期等证书域是可信的。</p>
<h2 id="认证协议"><a class="markdownIt-Anchor" href="#认证协议"></a> 认证协议</h2>
<p>实体认证的两种方式</p>
<p><code>弱认证</code>：基于口令的认证</p>
<p><code>强认证</code>：质询-应答协议</p>
<h3 id="弱认证"><a class="markdownIt-Anchor" href="#弱认证"></a> 弱认证</h3>
<p>用户提供一个口令，计算机验证该口令，如果输入的口令和该用户相对应的口令(<strong>可能存放在数据库中</strong>)对比不一致，则用户的身份得到认证，否则拒绝该口令，认证失败。</p>
<p><code>口令的脆弱性</code>：</p>
<ul>
<li>
<p>字典攻击(<strong>在线，离线</strong>)：攻击者可以<strong>穷举字典</strong>的口令，猜测出特定用户的口令，但需要有两个条件：</p>
<ol>
<li>口令在字典中</li>
<li>可以判断选用的口令是否正确</li>
</ol>
<p>因此要尽量避免<strong>口令泄露</strong><br>
<code>口令又是如何泄露的呢？</code></p>
<ol>
<li>
<p>网络明文传输</p>
</li>
<li>
<p>口令文件非法访问</p>
<p><code>解决的办法</code>：使用一个单向的hash函数将口令hash成<strong>伪随机数</strong>。对口令进行散列(<strong>加盐</strong>)</p>
</li>
</ol>
</li>
<li>
<p>工作站劫持</p>
</li>
<li>
<p>用户误用</p>
</li>
<li>
<p>搭线窃听</p>
</li>
</ul>
<h3 id="强认证"><a class="markdownIt-Anchor" href="#强认证"></a> 强认证</h3>
<p>这部分协议主要就是发送一个数，用<strong>密钥</strong>进行验证或解密，我个人还不是很熟悉。</p>
<h2 id="安全策略访问控制"><a class="markdownIt-Anchor" href="#安全策略访问控制"></a> 安全策略，访问控制</h2>
<h3 id="安全策略"><a class="markdownIt-Anchor" href="#安全策略"></a> 安全策略</h3>
<p>安全策略<strong>为系统定义安全</strong></p>
<p>安全策略将系统状态划分为两类</p>
<ul>
<li><strong>授权状态</strong> Authorized 系统允许进入的状态，安全的</li>
<li><strong>非授权状态</strong> Unauthorized 不安全的，如果系统进入这些状态，则违反了安全规定</li>
</ul>
<h3 id="安全系统"><a class="markdownIt-Anchor" href="#安全系统"></a> 安全系统</h3>
<h4 id="定义一"><a class="markdownIt-Anchor" href="#定义一"></a> 定义一</h4>
<p>安全系统是一种<code>始于已授权状态，但不能进入未授权状态</code>的系统。</p>
<h4 id="定义二"><a class="markdownIt-Anchor" href="#定义二"></a> 定义二</h4>
<p>如果系统进入了一个未授权状态，则称发生了一次安全破坏</p>
<h4 id="定义三"><a class="markdownIt-Anchor" href="#定义三"></a> 定义三</h4>
<p><strong>保密性</strong>：设X是实体的集合，并设I是信息，如果X中成员不能获取信息I，那么I关于X具有<strong>保密性</strong>。</p>
<h4 id="定义四"><a class="markdownIt-Anchor" href="#定义四"></a> 定义四</h4>
<p><strong>完整性</strong>：设X是实体的集合，并设I是某些信息或某种资源，如果X中所有成员都信任I，那么I关于X具有<strong>完整性</strong>。</p>
<h4 id="定义五"><a class="markdownIt-Anchor" href="#定义五"></a> 定义五</h4>
<p><strong>可用性</strong>：设X是实体的集合，并设I是一种资源，如果X中所有的成员都可以访问I，那么I关于X是具有<strong>可用性</strong>的。</p>
<p>以上<strong>保密性</strong>，<strong>完整性</strong>，<strong>可用性</strong>的定义都用到了集合的方法来表达，小结</p>
<ul>
<li><strong>不可获取信息</strong>(保密)</li>
<li><strong>信任</strong>(完整性)</li>
<li><strong>访问的服务质量</strong>(可用性)</li>
</ul>
<p>与ISO的CIA定义的区别是：<code>此处没有攻击者</code></p>
<h4 id="定义六"><a class="markdownIt-Anchor" href="#定义六"></a> 定义六</h4>
<p>安全机制是实施安全策略的某些部分的实体或规程。</p>
<h4 id="定义七"><a class="markdownIt-Anchor" href="#定义七"></a> 定义七</h4>
<p>安全模型是表达特定策略或策略集合的模型。</p>
<h4 id="两个结论"><a class="markdownIt-Anchor" href="#两个结论"></a> 两个结论</h4>
<ol>
<li>计算机系统的安全性是不可判定问题</li>
<li>判断一个程序是否为病毒是不可判定问题</li>
</ol>
<h3 id="访问控制"><a class="markdownIt-Anchor" href="#访问控制"></a> 访问控制</h3>
<p><code>&quot;防止未经授权使用资源，包括防止以非授权方式使用资源&quot;</code>，是计算机安全的<strong>核心元素</strong></p>
<h4 id="访问控制策略"><a class="markdownIt-Anchor" href="#访问控制策略"></a> 访问控制策略</h4>
<ol>
<li>
<p><strong>自主访问控制</strong> DAC</p>
<ul>
<li>基于请求者的身份和访问规则</li>
<li>实体可授权</li>
</ul>
</li>
<li>
<p><strong>强制访问控制</strong> MAC</p>
<ul>
<li>
<p>基于安全许可(<strong>实体的能力</strong>)和安全标记(<strong>资源的敏感度</strong>)</p>
</li>
<li>
<p>实体不可对另一实体授权</p>
</li>
</ul>
</li>
<li>
<p><strong>基于角色的访问控制</strong> RBAC</p>
</li>
</ol>
<h4 id="访问控制的基本元素"><a class="markdownIt-Anchor" href="#访问控制的基本元素"></a> 访问控制的基本元素</h4>
<ol>
<li><strong>主体</strong> - entity that can access objects
<ul>
<li>进程</li>
<li>三类：owner，group，world</li>
</ul>
</li>
<li><strong>客体</strong> access controlled resource
<ul>
<li>资源</li>
</ul>
</li>
<li><strong>访问权</strong> way in which subject accessed an object
<ul>
<li>e.g read，write，execute，delete，create</li>
</ul>
</li>
</ol>
<h3 id="自主访问控制"><a class="markdownIt-Anchor" href="#自主访问控制"></a> 自主访问控制</h3>
<ul>
<li>访问控制矩阵
<ul>
<li>主体：<strong>行</strong></li>
<li>客体：<strong>列</strong></li>
<li>矩阵元素：<strong>权限</strong>(访问权)</li>
</ul>
</li>
</ul>
<p>但在一个系统中，访问控制矩阵会显得很大，因为其中有许多的矩阵元素是0(也就是主体和客体毫无关系的)，改进思路：<strong>稀疏矩阵</strong>，<strong>可分解</strong></p>
<p><code>访问控制列表ACL</code></p>
<ul>
<li>概念上，ACL就像访问控制矩阵的列。</li>
<li>针对每一个客体，列出<strong>用户和权限</strong></li>
<li>特点：简化，高效</li>
</ul>
<p><code>能力表</code>：又称能力权证，C-List</p>
<ul>
<li>概念上能力表就像访问控制矩阵的行。</li>
<li>针对用户，指示用户所能访问的<strong>客体及其权限</strong></li>
</ul>
<p><code>ACL与C-List比较</code></p>
<p>给定主题，确定它能访问哪些客体，访问的权限是？</p>
<ul>
<li>使用能力表更简单</li>
</ul>
<p>给定客体，确定有哪些主体能够访问，访问的权限是？</p>
<ul>
<li>使用访问控制表回答简单</li>
</ul>
<h3 id="强制性访问控制"><a class="markdownIt-Anchor" href="#强制性访问控制"></a> 强制性访问控制</h3>
<ul>
<li>基于安全许可(<strong>实体的能力</strong>)和安全标记(<strong>资源的敏感度</strong>)</li>
<li>实体不可对另一实体授权</li>
</ul>
<h4 id="blp模型"><a class="markdownIt-Anchor" href="#blp模型"></a> BLP模型</h4>
<p>按线性排列定义<strong>安全许可</strong>(clearance)，对应于军事安全中的安全许可</p>
<ol>
<li>Top Secret (TS)：最高</li>
<li>Secret (S)</li>
<li>Confidential ©</li>
<li>Unclassified (UC)：最低</li>
</ol>
<p>主体有安全许可，客体有安全密级，有时候统称为<strong>安全密级</strong></p>
<img src="/2022/01/20/ComSec%E8%AE%A1%E7%AE%97%E6%9C%BA%E5%AE%89%E5%85%A8OverView/3.png" style="zoom: 75%;">
<p>BLP模型：</p>
<ul>
<li>
<p>防止主体读取安全密级比它的安全许可更高的客体。</p>
</li>
<li>
<p><code>简单安全条件</code>，预备版本：S可以读O，当且仅当lo&lt;=ls，且S对O具有自主性读权限</p>
</li>
<li>
<p>具有自主型读权限，意味着与自主访问控制部分相对应的S和O的访问控制矩阵条目中包含<strong>一项读的权限</strong>。</p>
</li>
<li>
<p>*-属性(<strong>星号属性</strong>)，预备版本：S可以写O，当且仅当ls&lt;=lo，且S对O具有自主型写权限。</p>
</li>
<li>
<p><code>基本安全定理</code>，预备版本：设系统的的某一个<strong>初始安全状态为</strong><span class="katex"><span class="katex-mathml"><math><semantics><mrow><msub><mi>σ</mi><mn>0</mn></msub></mrow><annotation encoding="application/x-tex">\sigma_{0}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.58056em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord mathdefault" style="margin-right:0.03588em;">σ</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.30110799999999993em;"><span style="top:-2.5500000000000003em;margin-left:-0.03588em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">0</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span>，T是状态转换的集合。如果T的每个元素都遵守<strong>简单安全条件</strong>(预备版)和*-属性(预备版)，那么对于每个i&gt;=0，状态<span class="katex"><span class="katex-mathml"><math><semantics><mrow><msub><mi>σ</mi><mi>i</mi></msub></mrow><annotation encoding="application/x-tex">\sigma_{i}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.58056em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord mathdefault" style="margin-right:0.03588em;">σ</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.31166399999999994em;"><span style="top:-2.5500000000000003em;margin-left:-0.03588em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathdefault mtight">i</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span>都是安全的。</p>
</li>
</ul>
<p><code>小结Bell-LaPadula模型：</code></p>
<ol>
<li>简单安全条件：<strong>不向上读</strong>(no reads up)</li>
<li>*-属性：<strong>不向下写</strong>(no writes down)</li>
<li>基本安全定理，如果初始状态为安全的系统，且所有状态转换都满足简单安全条件和星号属性，则系统中的所有状态都是安全的。</li>
<li>本质是<strong>强制型访问控制</strong>，但结合了自主型访问控制的内容。</li>
</ol>
<h3 id="基于角色的访问控制"><a class="markdownIt-Anchor" href="#基于角色的访问控制"></a> 基于角色的访问控制</h3>
<ul>
<li>基于角色而非身份的控制</li>
<li>基于角色授权，而不是单独给用户授权</li>
</ul>
<img src="/2022/01/20/ComSec%E8%AE%A1%E7%AE%97%E6%9C%BA%E5%AE%89%E5%85%A8OverView/4.png" style="zoom: 75%;">
<p>参考资料：</p>
<ol>
<li>
<p>bintou老师课件</p>
</li>
<li>
<p>《密码与编码学与网络安全》第七版</p>
</li>
</ol>
</div></article><div class="post-copyright"><div class="post-copyright__author"><span class="post-copyright-meta">文章作者: </span><span class="post-copyright-info"><a href="mailto:1127959736@qq.com">luo</a></span></div><div class="post-copyright__type"><span class="post-copyright-meta">文章链接: </span><span class="post-copyright-info"><a href="https://luo41.top/2022/01/20/ComSec计算机安全OverView/">https://luo41.top/2022/01/20/ComSec计算机安全OverView/</a></span></div><div class="post-copyright__notice"><span class="post-copyright-meta">版权声明: </span><span class="post-copyright-info">本博客所有文章除特别声明外，均采用 <a target="_blank" rel="noopener" href="https://creativecommons.org/licenses/by-nc-sa/4.0/">CC BY-NC-SA 4.0</a> 许可协议。转载请注明来自 <a href="https://luo41.top">luo's Blog</a>！</span></div></div><div class="post-meta__tag-list"><a class="post-meta__tags" href="/tags/%E8%AE%A1%E7%AE%97%E6%9C%BA%E5%AE%89%E5%85%A8/">计算机安全</a></div><nav id="pagination"><div class="prev-post pull-left"><a href="/2022/06/18/%E4%BB%8EJAVA%E8%99%9A%E6%8B%9F%E6%9C%BA%E7%9A%84%E8%A7%92%E5%BA%A6%E7%9C%8BJAVA%E9%87%8D%E8%BD%BD%E4%B8%8E%E9%87%8D%E5%86%99/"><i class="fa fa-chevron-left">  </i><span>从JAVA虚拟机的角度看JAVA重载与重写</span></a></div><div class="next-post pull-right"><a href="/2022/01/03/SpringMVC-%E5%89%8D%E7%AB%AF%E6%95%B0%E6%8D%AE%E4%BC%A0%E4%B8%80%E4%B8%AA%E5%AF%B9%E8%B1%A1%E7%9A%84%E5%80%BC/"><span>SpringMVC 前端数据传一个对象的值</span><i class="fa fa-chevron-right"></i></a></div></nav><div id="gitalk-container"></div><script>var gitalk = new Gitalk({
  clientID: '32255e197922b1ab75ad',
  clientSecret: '9bbe47fc29096bda7c2e430895ef65fa58c8d7db',
  repo: 'zhengjianda.github.io',
  owner: 'zhengjianda',
  admin: 'zhengjianda',
  id: md5(decodeURI(location.pathname)),
  language: 'zh-CN'
})
gitalk.render('gitalk-container')</script></div></div><footer class="footer-bg" style="background-image: url(/background2.jpg)"><div class="layout" id="footer"><div class="copyright">&copy;2021 - 2022 By luo</div><div class="framework-info"><span>驱动 - </span><a target="_blank" rel="noopener" href="http://hexo.io"><span>Hexo</span></a><span class="footer-separator">|</span><span>主题 - </span><a target="_blank" rel="noopener" href="https://github.com/Molunerfinn/hexo-theme-melody"><span>Melody</span></a></div><div class="footer_custom_text">hitokoto</div><div class="busuanzi"><script async src="//busuanzi.ibruce.info/busuanzi/2.3/busuanzi.pure.mini.js"></script><span id="busuanzi_container_page_pv"><i class="fa fa-file"></i><span id="busuanzi_value_page_pv"></span><span></span></span></div></div></footer><i class="fa fa-arrow-up" id="go-up" aria-hidden="true"></i><script src="https://cdn.jsdelivr.net/npm/animejs@latest/lib/anime.min.js"></script><script src="https://cdn.jsdelivr.net/npm/jquery@latest/dist/jquery.min.js"></script><script src="https://cdn.jsdelivr.net/npm/@fancyapps/fancybox@latest/dist/jquery.fancybox.min.js"></script><script src="https://cdn.jsdelivr.net/npm/velocity-animate@latest/velocity.min.js"></script><script src="https://cdn.jsdelivr.net/npm/velocity-ui-pack@latest/velocity.ui.min.js"></script><script src="/js/utils.js?version=1.9.0"></script><script src="/js/fancybox.js?version=1.9.0"></script><script src="/js/sidebar.js?version=1.9.0"></script><script src="/js/copy.js?version=1.9.0"></script><script src="/js/fireworks.js?version=1.9.0"></script><script src="/js/transition.js?version=1.9.0"></script><script src="/js/scroll.js?version=1.9.0"></script><script src="/js/head.js?version=1.9.0"></script><link rel="stylesheet" type="text/css" href="https://cdn.jsdelivr.net/npm/katex@latest/dist/katex.min.css"><script src="https://cdn.jsdelivr.net/npm/katex-copytex@latest/dist/katex-copytex.min.js"></script><link rel="stylesheet" type="text/css" href="https://cdn.jsdelivr.net/npm/katex-copytex@latest/dist/katex-copytex.min.css"><script src="/js/katex.js"></script><script src="/js/search/local-search.js"></script><script id="ribbon" src="/js/third-party/canvas-ribbon.js" size="100" alpha="0.6" zIndex="-1" data-click="false"></script><script>if(/Android|webOS|iPhone|iPod|iPad|BlackBerry/i.test(navigator.userAgent)) {
  $('#nav').addClass('is-mobile')
  $('footer').addClass('is-mobile')
  $('#top-container').addClass('is-mobile')
}</script><div class="search-dialog" id="local-search"><div class="search-dialog__title" id="local-search-title">本地搜索</div><div id="local-input-panel"><div id="local-search-input"><div class="local-search-box"><input class="local-search-box--input" placeholder="搜索文章"></div></div></div><hr><div id="local-search-results"><div id="local-hits"></div><div id="local-stats"><div class="local-search-stats__hr" id="hr"><span>由</span> <a target="_blank" rel="noopener" href="https://github.com/wzpan/hexo-generator-search" style="color:#49B1F5;">hexo-generator-search</a>
 <span>提供支持</span></div></div></div><span class="search-close-button"><i class="fa fa-times"></i></span></div><div class="search-mask"></div></body></html>